{
  final LocalDate firstEventStartDate=new LocalDate(2014,03,15);
  final List<InvoiceItem> invoiceItems=new ArrayList<InvoiceItem>();
  for (int i=0; i < 1; i++) {
    invoiceItems.add(createUsageItem(firstEventStartDate.plusMonths(i)));
  }
  final LocalDate targetDate=invoiceItems.get(invoiceItems.size() - 1).getEndDate();
  final Map<String,Usage> knownUsage=new HashMap<String,Usage>();
  final DefaultTieredBlock block=createDefaultTieredBlock("unit",100,1000,BigDecimal.ONE);
  final DefaultTier tier=createDefaultTier(block);
  final DefaultUsage usage=createDefaultUsage(usageName,BillingPeriod.MONTHLY,tier);
  knownUsage.put(usageName,usage);
  final LocalDate result=rawUsageOptimizer.getOptimizedRawUsageStartDate(firstEventStartDate,targetDate,invoiceItems,knownUsage);
  Assert.assertEquals(result.compareTo(firstEventStartDate),0);
}
