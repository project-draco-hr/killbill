{
  final Collection<InvoicePayment> invoicePayments=Collections2.transform(dao.getInvoicePayments(paymentId,context),new Function<InvoicePaymentModelDao,InvoicePayment>(){
    @Override public InvoicePayment apply(    final InvoicePaymentModelDao input){
      return new DefaultInvoicePayment(input);
    }
  }
);
  if (invoicePayments.size() == 0) {
    return null;
  }
  return Collections2.filter(invoicePayments,new Predicate<InvoicePayment>(){
    @Override public boolean apply(    InvoicePayment input){
      return input.getType() == InvoicePaymentType.ATTEMPT;
    }
  }
).iterator().next();
}
