{
  log.info("Received invoice creation notification for account {} and invoice {}",event.getAccountId(),event.getInvoiceId());
  Account account=null;
  try {
    account=accountUserApi.getAccountById(event.getAccountId());
    if (isAccountAutoPayOff(account.getId())) {
      return;
    }
    CallContext context=new DefaultCallContext("PaymentRequestProcessor",CallOrigin.INTERNAL,UserType.SYSTEM,event.getUserToken(),clock);
    paymentApi.createPayment(account,event.getInvoiceId(),context);
  }
 catch (  AccountApiException e) {
    log.error("Failed to process invoice payment",e);
  }
catch (  PaymentApiException e) {
    log.error("Failed to process invoice payment",e);
  }
}
