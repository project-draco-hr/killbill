{
  log.info("Received invoice creation notification for account {} and invoice {}",event.getAccountId(),event.getInvoiceId());
  try {
    final Account account=accountUserApi.getAccountById(event.getAccountId());
    if (account == null) {
    }
 else {
      List<Either<PaymentError,PaymentInfo>> results=paymentApi.createPayment(account,Arrays.asList(event.getInvoiceId().toString()));
      if (results.isEmpty()) {
        eventBus.post(new PaymentError("unknown","No payment processed"));
      }
 else {
        Either<PaymentError,PaymentInfo> result=results.get(0);
        eventBus.post(result.isLeft() ? result.getLeft() : result.getRight());
      }
    }
  }
 catch (  EventBusException ex) {
  }
}
