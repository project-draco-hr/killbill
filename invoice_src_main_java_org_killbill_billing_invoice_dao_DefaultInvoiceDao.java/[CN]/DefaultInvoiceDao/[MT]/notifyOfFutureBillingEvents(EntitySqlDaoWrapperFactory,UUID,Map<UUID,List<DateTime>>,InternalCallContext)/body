{
  final long dryRunNotificationTime=invoiceConfig.getDryRunNotificationSchedule().getMillis();
  final boolean isInvoiceNotificationEnabled=dryRunNotificationTime > 0;
  for (  final UUID subscriptionId : callbackDateTimePerSubscriptions.keySet()) {
    final List<DateTime> callbackDateTimeUTC=callbackDateTimePerSubscriptions.get(subscriptionId);
    for (    final DateTime cur : callbackDateTimeUTC) {
      if (isInvoiceNotificationEnabled) {
        final DateTime curDryRunNotificationTime=cur.minus(dryRunNotificationTime);
        if (curDryRunNotificationTime.isAfter(clock.getUTCNow())) {
          nextBillingDatePoster.insertNextBillingDryRunNotificationFromTransaction(entitySqlDaoWrapperFactory,accountId,subscriptionId,curDryRunNotificationTime,cur,internalCallContext);
        }
      }
      nextBillingDatePoster.insertNextBillingNotificationFromTransaction(entitySqlDaoWrapperFactory,accountId,subscriptionId,cur,internalCallContext);
    }
  }
}
