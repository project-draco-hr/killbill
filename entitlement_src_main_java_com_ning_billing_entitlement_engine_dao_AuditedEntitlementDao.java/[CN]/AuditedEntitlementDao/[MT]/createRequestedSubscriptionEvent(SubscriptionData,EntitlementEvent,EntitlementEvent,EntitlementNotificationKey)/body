{
  final SubscriptionData subscriptionCopy=new SubscriptionData(new SubscriptionBuilder(subscription));
  nextEvent.reactivate();
  final ImmutableList<EntitlementEvent> events;
  if (prevEvent != null) {
    prevEvent.reactivate();
    events=ImmutableList.<EntitlementEvent>of(prevEvent,nextEvent);
  }
 else {
    events=ImmutableList.<EntitlementEvent>of(nextEvent);
  }
  subscriptionCopy.rebuildTransitions(events,catalogService.getFullCatalog());
  final EffectiveSubscriptionEvent transitionFromEvent=subscriptionCopy.getTransitionFromEvent(nextEvent,notificationKey.getSeqId());
  return new DefaultRequestedSubscriptionEvent(transitionFromEvent);
}
