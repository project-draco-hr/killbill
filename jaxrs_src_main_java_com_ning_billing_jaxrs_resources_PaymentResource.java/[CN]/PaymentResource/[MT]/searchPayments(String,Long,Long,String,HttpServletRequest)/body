{
  final TenantContext tenantContext=context.createContext(request);
  final Pagination<Payment> payments;
  if (Strings.isNullOrEmpty(pluginName)) {
    payments=paymentApi.searchPayments(searchKey,offset,limit,tenantContext);
  }
 else {
    payments=paymentApi.searchPayments(searchKey,offset,limit,pluginName,tenantContext);
  }
  final URI nextPageUri=uriBuilder.nextPage(PaymentResource.class,"searchPayments",payments.getNextOffset(),limit,ImmutableMap.<String,String>of());
  return buildStreamingPaginationResponse(payments,new Function<Payment,PaymentJson>(){
    @Override public PaymentJson apply(    final Payment payment){
      return new PaymentJson(payment,null);
    }
  }
,nextPageUri);
}
