{
synchronized (recyclingMonitor) {
    if (out != null && !out.isEmpty()) {
      out.close();
    }
    out=new StreamyBytesPersistentOutputStream(basePath,prefix,inputBuffer,deleteFilesOnClose);
    smileGenerator=smileFactory.createJsonGenerator(out,JsonEncoding.UTF8);
    smileGenerator.flush();
    out.reset();
    samplesforTimestampWritten.set(0);
  }
}
