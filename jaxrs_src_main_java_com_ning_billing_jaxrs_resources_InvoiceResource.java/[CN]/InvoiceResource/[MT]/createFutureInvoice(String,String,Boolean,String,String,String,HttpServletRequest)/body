{
  final CallContext callContext=context.createContext(createdBy,reason,comment,request);
  final Account account=accountApi.getAccountById(UUID.fromString(accountId),callContext);
  final DateTime inputDateTime=DATE_TIME_FORMATTER.parseDateTime(targetDateTime);
  final LocalDate inputDate=inputDateTime.toDateTime(account.getTimeZone()).toLocalDate();
  final Invoice generatedInvoice=invoiceApi.triggerInvoiceGeneration(UUID.fromString(accountId),inputDate,dryRun,callContext);
  if (dryRun) {
    return Response.status(Status.OK).entity(new InvoiceJsonSimple(generatedInvoice)).build();
  }
 else {
    return uriBuilder.buildResponse(InvoiceResource.class,"getInvoice",generatedInvoice.getId());
  }
}
