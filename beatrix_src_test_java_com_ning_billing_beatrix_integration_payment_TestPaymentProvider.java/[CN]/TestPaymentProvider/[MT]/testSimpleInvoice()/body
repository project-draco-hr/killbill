{
  final Account account=testHelper.createTestCreditCardAccount();
  Invoice invoice=testHelper.createTestInvoice(account);
  await().atMost(1,MINUTES).until(new Callable<Boolean>(){
    @Override public Boolean call() throws Exception {
      List<PaymentInfoEvent> processedPayments=paymentInfoReceiver.getProcessedPayments();
      List<PaymentErrorEvent> errors=paymentInfoReceiver.getErrors();
      return processedPayments.size() == 1 || errors.size() == 1;
    }
  }
);
  assertFalse(paymentInfoReceiver.getProcessedPayments().isEmpty());
  assertTrue(invoice.getPayments().size() > 0);
}
