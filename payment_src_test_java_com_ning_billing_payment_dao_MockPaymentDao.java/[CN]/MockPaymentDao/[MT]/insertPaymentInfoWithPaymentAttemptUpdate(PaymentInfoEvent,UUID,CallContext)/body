{
  payments.put(paymentInfo.getId(),paymentInfo);
  if (paymentAttemptId != null) {
    PaymentAttempt existingPaymentAttempt=paymentAttempts.get(paymentAttemptId);
    if (existingPaymentAttempt != null) {
      paymentAttempts.put(existingPaymentAttempt.getId(),((DefaultPaymentAttempt)existingPaymentAttempt).cloner().setPaymentId(paymentInfo.getId()).build());
    }
  }
}
