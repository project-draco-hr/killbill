{
  super.beforeMethod();
  final DefaultTenantDao tenantDao=new DefaultTenantDao(getDBI(),clock,cacheControllerDispatcher,new DefaultNonEntityDao(getDBI()));
  tenant=new DefaultTenant(UUID.randomUUID(),null,null,UUID.randomUUID().toString(),UUID.randomUUID().toString(),UUID.randomUUID().toString());
  tenantDao.create(new TenantModelDao(tenant),internalCallContext);
  final BoneCPConfig dbConfig=new BoneCPConfig();
  dbConfig.setJdbcUrl(getDBTestingHelper().getJdbcConnectionString());
  dbConfig.setUsername(MysqlTestingHelper.USERNAME);
  dbConfig.setPassword(MysqlTestingHelper.PASSWORD);
  final KillbillJdbcRealm jdbcRealm;
  jdbcRealm=new KillbillJdbcRealm();
  jdbcRealm.setDataSource(new BoneCPDataSource(dbConfig));
  securityManager=new DefaultSecurityManager(jdbcRealm);
}
