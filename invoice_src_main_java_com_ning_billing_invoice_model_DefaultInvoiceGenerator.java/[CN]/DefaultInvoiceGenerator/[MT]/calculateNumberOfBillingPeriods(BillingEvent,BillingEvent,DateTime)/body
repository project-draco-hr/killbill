{
  BillingMode billingMode=getBillingMode(firstEvent.getBillingMode());
  DateTime startDate=firstEvent.getEffectiveDate();
  int billingCycleDay=firstEvent.getBillCycleDay();
  BillingPeriod billingPeriod=firstEvent.getBillingPeriod();
  DateTime endDate=secondEvent.getEffectiveDate();
  try {
    return billingMode.calculateNumberOfBillingCycles(startDate,endDate,targetDate,billingCycleDay,billingPeriod);
  }
 catch (  InvalidDateSequenceException e) {
    return BigDecimal.ZERO;
  }
}
