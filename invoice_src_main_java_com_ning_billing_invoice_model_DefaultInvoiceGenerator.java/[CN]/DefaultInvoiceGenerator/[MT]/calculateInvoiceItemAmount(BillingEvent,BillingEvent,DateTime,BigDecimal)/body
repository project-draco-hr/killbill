{
  IBillingMode billingMode=getBillingMode(firstEvent.getBillingMode());
  DateTime startDate=firstEvent.getEffectiveDate();
  int billingCycleDay=firstEvent.getBillCycleDay();
  BillingPeriod billingPeriod=firstEvent.getBillingPeriod();
  DateTime endDate=secondEvent.getEffectiveDate();
  try {
    BigDecimal numberOfBillingCycles;
    numberOfBillingCycles=billingMode.calculateNumberOfBillingCycles(startDate,endDate,targetDate,billingCycleDay,billingPeriod);
    return numberOfBillingCycles.multiply(rate);
  }
 catch (  InvalidDateSequenceException e) {
    return BigDecimal.ZERO;
  }
}
