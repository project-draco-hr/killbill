{
  validateUniqueTransactionExternalKey(directPaymentTransactionExternalKey,internalCallContext);
  final UUID nonNullDirectPaymentId=directPaymentAutomatonRunner.run(TransactionType.REFUND,account,directPaymentId,directPaymentTransactionExternalKey,amount,currency,shouldLockAccountAndDispatch,properties,callContext,internalCallContext);
  final DirectPayment directPayment=getPayment(nonNullDirectPaymentId,true,properties,callContext,internalCallContext);
  postPaymentEvent(account,directPayment,directPaymentTransactionExternalKey,internalCallContext);
  return directPayment;
}
