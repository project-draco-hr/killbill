{
  DirectPayment directPayment=null;
  try {
    validateUniqueTransactionExternalKey(directPaymentTransactionExternalKey,internalCallContext);
    final UUID nonNullDirectPaymentId=directPaymentAutomatonRunner.run(transactionType,account,attemptId,paymentMethodId,directPaymentId,directPaymentExternalKey,directPaymentTransactionExternalKey,amount,currency,shouldLockAccountAndDispatch,properties,callContext,internalCallContext);
    directPayment=getPayment(nonNullDirectPaymentId,true,properties,callContext,internalCallContext);
    return directPayment;
  }
  finally {
    postPaymentEvent(isApiPayment,account,transactionType,directPayment,directPaymentTransactionExternalKey,internalCallContext);
  }
}
