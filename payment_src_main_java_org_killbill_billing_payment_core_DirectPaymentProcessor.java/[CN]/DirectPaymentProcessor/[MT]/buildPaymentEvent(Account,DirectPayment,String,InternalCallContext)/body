{
  final DirectPaymentTransaction directPaymentTransaction=Iterables.<DirectPaymentTransaction>tryFind(directPayment.getTransactions(),new Predicate<DirectPaymentTransaction>(){
    @Override public boolean apply(    final DirectPaymentTransaction input){
      return input.getExternalKey().equals(transactionExternalKey);
    }
  }
).get();
switch (directPaymentTransaction.getPaymentStatus()) {
case SUCCESS:
case PENDING:
    return new DefaultPaymentInfoEvent(account.getId(),null,directPayment.getId(),directPaymentTransaction.getAmount(),directPayment.getPaymentNumber(),directPaymentTransaction.getPaymentStatus(),directPaymentTransaction.getEffectiveDate(),context.getAccountRecordId(),context.getTenantRecordId(),context.getUserToken());
case PAYMENT_FAILURE_ABORTED:
  return new DefaultPaymentErrorEvent(account.getId(),null,directPayment.getId(),directPaymentTransaction.getPaymentInfoPlugin() == null ? null : directPaymentTransaction.getPaymentInfoPlugin().getGatewayError(),context.getAccountRecordId(),context.getTenantRecordId(),context.getUserToken());
case PLUGIN_FAILURE_ABORTED:
default :
return new DefaultPaymentPluginErrorEvent(account.getId(),null,directPayment.getId(),directPaymentTransaction.getPaymentInfoPlugin() == null ? null : directPaymentTransaction.getPaymentInfoPlugin().getGatewayError(),context.getAccountRecordId(),context.getTenantRecordId(),context.getUserToken());
}
}
