{
  final EntitlementEvent previousEvent=createEntitlementEvent(subscriptionData.getStartDate(),previousProductName,commonPhaseType,ApiEventType.CREATE,subscriptionData.getActiveVersion());
  final EntitlementEvent event=createEntitlementEvent(effectiveChangeDate,newProductName,commonPhaseType,ApiEventType.CHANGE,subscriptionData.getActiveVersion());
  subscriptionData.rebuildTransitions(ImmutableList.<EntitlementEvent>of(previousEvent,event),catalogService.getFullCatalog());
  final List<EffectiveSubscriptionInternalEvent> newTransitions=subscriptionData.getAllTransitions();
  Assert.assertEquals(newTransitions.size(),2);
  Assert.assertNull(newTransitions.get(0).getPreviousPhase());
  Assert.assertEquals(newTransitions.get(0).getNextPhase(),newTransitions.get(1).getPreviousPhase());
  Assert.assertNotNull(newTransitions.get(1).getNextPhase());
}
