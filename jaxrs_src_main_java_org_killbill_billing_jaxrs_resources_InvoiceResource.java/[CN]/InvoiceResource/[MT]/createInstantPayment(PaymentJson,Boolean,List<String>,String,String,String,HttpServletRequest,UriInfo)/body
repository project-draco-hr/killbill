{
  final Iterable<PluginProperty> pluginProperties=extractPluginProperties(pluginPropertiesString);
  final CallContext callContext=context.createContext(createdBy,reason,comment,request);
  final Account account=accountUserApi.getAccountById(UUID.fromString(payment.getAccountId()),callContext);
  final UUID invoiceId=UUID.fromString(payment.getInvoiceId());
  createPurchaseForInvoice(account,invoiceId,payment.getPurchaseAmount(),externalPayment,callContext);
  return uriBuilder.buildResponse(uriInfo,InvoiceResource.class,"getPayments",payment.getInvoiceId());
}
