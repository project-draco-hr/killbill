{
  final PaymentAttemptModelDao attempt=new PaymentAttemptModelDao(account.getId(),invoice.getId(),payment.getId(),account.getPaymentMethodId(),clock.getUTCNow(),requestedAmount,invoice.getCurrency());
  paymentDao.updatePaymentWithNewAttempt(payment.getId(),attempt,context);
  return processPaymentWithAccountLocked(plugin,account,invoice,payment,attempt,false,properties,context);
}
