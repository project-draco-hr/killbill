{
  try {
    final String accountDdl=IOUtils.toString(AccountSqlDao.class.getResourceAsStream("/com/ning/billing/account/ddl.sql"));
    final String utilDdl=IOUtils.toString(AccountSqlDao.class.getResourceAsStream("/com/ning/billing/util/ddl.sql"));
    helper.startMysql();
    helper.initDb(accountDdl);
    helper.initDb(utilDdl);
    dbi=helper.getDBI();
    bus=new InMemoryBus();
    final BusService busService=new DefaultBusService(bus);
    ((DefaultBusService)busService).startBus();
    accountDao=new AuditedAccountDao(dbi,bus);
    accountDao.test();
    accountEmailDao=new AuditedAccountEmailDao(dbi);
    accountEmailDao.test();
    final Clock clock=new ClockMock();
    context=new DefaultCallContextFactory(clock).createCallContext("Account Dao Tests",CallOrigin.TEST,UserType.TEST);
  }
 catch (  Throwable t) {
    fail(t.toString());
  }
}
