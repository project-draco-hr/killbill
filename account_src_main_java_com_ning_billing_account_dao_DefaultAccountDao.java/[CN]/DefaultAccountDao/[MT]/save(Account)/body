{
  final String accountId=account.getId().toString();
  final String objectType=DefaultAccount.OBJECT_TYPE;
  accountDao.inTransaction(new Transaction<Void,AccountSqlDao>(){
    @Override public Void inTransaction(    AccountSqlDao accountDao,    TransactionStatus status) throws Exception {
      Account currentAccount=accountDao.getById(accountId);
      accountDao.save(account);
      FieldStoreDao fieldStoreDao=accountDao.become(FieldStoreDao.class);
      fieldStoreDao.save(accountId,objectType,account.getFieldList());
      TagStoreDao tagStoreDao=fieldStoreDao.become(TagStoreDao.class);
      tagStoreDao.save(accountId,objectType,account.getTagList());
      if (currentAccount == null) {
        AccountCreationNotification creationEvent=new DefaultAccountCreationEvent(account);
        eventBus.post(creationEvent);
      }
 else {
        AccountChangeNotification changeEvent=new DefaultAccountChangeNotification(account.getId(),currentAccount,account);
        if (changeEvent.hasChanges()) {
          eventBus.post(changeEvent);
        }
      }
      return null;
    }
  }
);
}
