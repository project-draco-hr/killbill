{
  final Date now=clock.getUTCNow().toDate();
  final Date nextAvailable=clock.getUTCNow().plus(DELTA_IN_PROCESSING_TIME_MS).toDate();
  final List<BusEventEntry> entries=dao.getNextBusEventEntries(config.getPrefetchAmount(),hostname,now,context);
  final List<BusEventEntry> claimedEntries=new LinkedList<BusEventEntry>();
  for (  final BusEventEntry entry : entries) {
    final InternalCallContext rehydratedContext=internalCallContextFactory.createInternalCallContext(entry.getTenantRecordId(),entry.getAccountRecordId(),context);
    final boolean claimed=(dao.claimBusEvent(hostname,nextAvailable,entry.getId(),now,rehydratedContext) == 1);
    if (claimed) {
      dao.insertClaimedHistory(hostname,now,entry.getId(),rehydratedContext);
      claimedEntries.add(entry);
    }
  }
  return claimedEntries;
}
