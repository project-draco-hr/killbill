{
  Handle handle=dbi.open();
  StringBuilder sb=new StringBuilder();
  sb.append("select * from audit_log a ");
  sb.append("inner join account_email_history aeh on a.record_id = aeh.history_record_id ");
  sb.append("where a.table_name = 'account_email_history' ");
  sb.append(String.format("and aeh.account_id='%s'",accountId.toString()));
  List<Map<String,Object>> result=handle.select(sb.toString());
  assertEquals(result.size(),expectedCount);
  sb=new StringBuilder();
  sb.append("select * from account_email_history ");
  sb.append(String.format("where account_id='%s'",accountId.toString()));
  result=handle.select(sb.toString());
  assertEquals(result.size(),expectedCount);
  handle.close();
}
