{
  final AccountModelDao account=createTestAccount(1);
  final TagDefinition definition=new DefaultTagDefinition("Test Tag","For testing only",false);
  final TagDefinitionSqlDao tagDefinitionDao=dbi.onDemand(TagDefinitionSqlDao.class);
  tagDefinitionDao.create(new TagDefinitionModelDao(definition),internalCallContext);
  final TagDao tagDao=new DefaultTagDao(dbi,tagEventBuilder,bus);
  final TagDefinitionModelDao tagDefinition=tagDefinitionDao.getById(definition.getId().toString(),internalCallContext);
  final Tag tag=new DescriptiveTag(tagDefinition.getId(),ObjectType.ACCOUNT,account.getId(),internalCallContext.getCreatedDate());
  tagDao.create(new TagModelDao(tag),internalCallContext);
  final List<TagModelDao> tags=tagDao.getTags(account.getId(),ObjectType.ACCOUNT,internalCallContext);
  assertEquals(tags.size(),1);
  assertEquals(tags.get(0).getTagDefinitionId(),definition.getId());
}
