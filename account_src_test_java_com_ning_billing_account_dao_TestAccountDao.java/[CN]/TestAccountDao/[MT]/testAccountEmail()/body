{
  List<AccountEmail> emails=new ArrayList<AccountEmail>();
  final UUID accountId=UUID.randomUUID();
  final AccountEmail email=new DefaultAccountEmail(accountId,"test@gmail.com");
  accountEmailDao.create(email,internalCallContext);
  emails=accountEmailDao.getByAccountId(accountId,internalCallContext);
  assertEquals(emails.size(),1);
  verifyAccountEmailAuditAndHistoryCount(accountId,1);
  final AccountEmail updatedEmail=new DefaultAccountEmail(email,"test2@gmail.com");
  emails.clear();
  emails.add(updatedEmail);
  accountEmailDao.create(updatedEmail,internalCallContext);
  emails=accountEmailDao.getByAccountId(accountId,internalCallContext);
  assertEquals(emails.size(),1);
  verifyAccountEmailAuditAndHistoryCount(accountId,3);
  accountEmailDao.delete(email,internalCallContext);
  accountEmailDao.delete(updatedEmail,internalCallContext);
  emails=accountEmailDao.getByAccountId(accountId,internalCallContext);
  assertEquals(emails.size(),0);
  verifyAccountEmailAuditAndHistoryCount(accountId,4);
}
