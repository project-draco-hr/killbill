{
  BigDecimal result=BigDecimal.ZERO;
  final Iterable<DirectPaymentTransaction> filtered=Iterables.filter(transactions,new Predicate<DirectPaymentTransaction>(){
    @Override public boolean apply(    final DirectPaymentTransaction input){
      return input.getTransactionType() == transactiontype && TransactionStatus.SUCCESS.equals(input.getTransactionStatus());
    }
  }
);
  if (TransactionType.AUTHORIZE.equals(transactiontype) && filtered.iterator().hasNext()) {
    result=filtered.iterator().next().getAmount();
  }
 else {
    for (    final DirectPaymentTransaction dpt : filtered) {
      result=result.add(dpt.getAmount());
    }
  }
  return result;
}
