{
  if (Frequency.HOURLY.equals(frequency) && (System.currentTimeMillis() - lastRun.get()) >= 3600000) {
    return true;
  }
 else   if (Frequency.DAILY.equals(frequency)) {
    if (refreshTimeOfTheDayGMT == null && (System.currentTimeMillis() - lastRun.get()) >= 86400000) {
      return true;
    }
 else     if (refreshTimeOfTheDayGMT != null && new DateTime(DateTimeZone.UTC).getHourOfDay() == refreshTimeOfTheDayGMT && (System.currentTimeMillis() - lastRun.get()) >= 3600000) {
      return true;
    }
 else {
      return false;
    }
  }
 else {
    return false;
  }
}
