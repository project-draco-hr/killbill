{
  clock.setTime(new DateTime(2012,12,1,12,40,DateTimeZone.UTC));
  final DateTime start=clock.getUTCNow();
  final AccumulatorSampleConsumer sampleConsumer=new AccumulatorSampleConsumer(TimeAggregationMode.DAYS);
  sampleConsumer.processOneSample(start,SampleOpcode.DOUBLE,(double)1);
  sampleConsumer.processOneSample(start.plusHours(4),SampleOpcode.DOUBLE,(double)4);
  sampleConsumer.processOneSample(start.plusDays(1),SampleOpcode.DOUBLE,(double)1);
  sampleConsumer.processOneSample(start.plusDays(2),SampleOpcode.DOUBLE,(double)10);
  sampleConsumer.processOneSample(start.plusDays(2),SampleOpcode.INT,20);
  Assert.assertEquals(sampleConsumer.flush(),"1354320000,5.0,1354406400,1.0,1354492800,10.0,1354492800,20.0");
}
