{
  InputStream is=new ByteArrayInputStream(configXml.getBytes());
  config=XMLLoader.getObjectFromStreamNoValidation(is,OverdueConfig.class);
  overdueWrapperFactory.setOverdueConfig(config);
  SubscriptionBundle bundle;
  OverdueWrapper<SubscriptionBundle> wrapper;
  OverdueState<SubscriptionBundle> state;
  state=config.getBundleStateSet().findState("OD1");
  bundle=createBundle(clock.getUTCNow().minusDays(31));
  wrapper=overdueWrapperFactory.createOverdueWrapperFor(bundle);
  wrapper.refresh();
  checkStateApplied(state);
  state=config.getBundleStateSet().findState("OD2");
  bundle=createBundle(clock.getUTCNow().minusDays(41));
  wrapper=overdueWrapperFactory.createOverdueWrapperFor(bundle);
  wrapper.refresh();
  checkStateApplied(state);
  state=config.getBundleStateSet().findState("OD3");
  bundle=createBundle(clock.getUTCNow().minusDays(51));
  wrapper=overdueWrapperFactory.createOverdueWrapperFor(bundle);
  wrapper.refresh();
  checkStateApplied(state);
}
