{
  this.dao=dbi.onDemand(PersistentBusSqlDao.class);
  this.clock=clock;
  this.objectMapper=new ObjectMapper();
  this.objectMapper.disable(SerializationConfig.Feature.WRITE_DATES_AS_TIMESTAMPS);
  this.eventBusDelegate=new EventBusDelegate("Killbill EventBus");
  final ThreadGroup group=new ThreadGroup(DefaultBusService.EVENT_BUS_GROUP_NAME);
  this.executor=Executors.newFixedThreadPool(NB_BUS_THREADS,new ThreadFactory(){
    @Override public Thread newThread(    Runnable r){
      return new Thread(group,r,DefaultBusService.EVENT_BUS_TH_NAME);
    }
  }
);
  this.hostname=Hostname.get();
  this.isProcessingEvents=false;
}
