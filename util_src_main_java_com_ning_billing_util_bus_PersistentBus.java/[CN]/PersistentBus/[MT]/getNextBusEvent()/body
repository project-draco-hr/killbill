{
  final Date now=clock.getUTCNow().toDate();
  final Date nextAvailable=clock.getUTCNow().plus(DELTA_IN_PROCESSING_TIME_MS).toDate();
  BusEventEntry input=dao.getNextBusEventEntry(MAX_BUS_EVENTS,hostname,now);
  if (input == null) {
    return Collections.emptyList();
  }
  final boolean claimed=(dao.claimBusEvent(hostname,nextAvailable,input.getId(),now) == 1);
  if (claimed) {
    dao.insertClaimedHistory(hostname,now,input.getId());
    return Collections.singletonList(input);
  }
  return Collections.emptyList();
}
