{
  final SubscriptionBundle bundle=verifyFirstBundle(account);
  Subscription subscription=verifyFirstSubscription(account,bundle);
  busHandler.pushExpectedEvent(TestApiListener.NextEvent.PHASE);
  busHandler.pushExpectedEvent(TestApiListener.NextEvent.INVOICE);
  busHandler.pushExpectedEvent(TestApiListener.NextEvent.PAYMENT);
  clock.addDeltaFromReality(AT_LEAST_ONE_MONTH_MS);
  Assert.assertTrue(busHandler.isCompleted(DELAY));
  verifyBSTWithTrialAndEvergreenPhases(account,bundle,subscription);
  subscription=entitlementUserApi.getSubscriptionFromId(subscription.getId(),callContext);
  subscription.cancel(clock.getUTCNow(),callContext);
  waitALittle();
  verifyBSTWithTrialAndEvergreenPhasesAndCancellation(account,bundle,subscription);
  clock.addDeltaFromReality(AT_LEAST_ONE_MONTH_MS + 100);
  assertTrue(busHandler.isCompleted(DELAY));
  waitALittle();
  verifyBSTWithTrialAndEvergreenPhasesAndCancellationAndSystemCancellation(account,bundle,subscription);
}
