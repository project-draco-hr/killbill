{
  final UUID invoiceId=UUID.randomUUID();
  final String accountKey=UUID.randomUUID().toString();
  final BusinessInvoice invoice=createInvoice(invoiceId,accountKey);
  Assert.assertNull(invoiceSqlDao.getInvoice(invoice.getInvoiceId().toString()));
  Assert.assertEquals(invoiceSqlDao.deleteInvoice(invoice.getInvoiceId().toString()),0);
  Assert.assertEquals(invoiceSqlDao.createInvoice(invoice),1);
  Assert.assertEquals(invoiceSqlDao.getInvoice(invoice.getInvoiceId().toString()),invoice);
  Assert.assertEquals(invoiceSqlDao.getInvoicesForAccount(invoice.getAccountKey()).size(),1);
  Assert.assertEquals(invoiceSqlDao.getInvoicesForAccount(invoice.getAccountKey()).get(0),invoice);
  invoice.setInvoiceDate(new DateTime(DateTimeZone.UTC));
  Assert.assertEquals(invoiceSqlDao.updateInvoice(invoice),1);
  Assert.assertEquals(invoiceSqlDao.getInvoice(invoice.getInvoiceId().toString()),invoice);
  Assert.assertEquals(invoiceSqlDao.getInvoicesForAccount(invoice.getAccountKey()).size(),1);
  Assert.assertEquals(invoiceSqlDao.getInvoicesForAccount(invoice.getAccountKey()).get(0),invoice);
  Assert.assertEquals(invoiceSqlDao.deleteInvoice(invoice.getInvoiceId().toString()),1);
  Assert.assertNull(invoiceSqlDao.getInvoice(invoice.getInvoiceId().toString()));
  Assert.assertEquals(invoiceSqlDao.getInvoicesForAccount(invoice.getAccountKey()).size(),0);
}
