{
  if (entitlementEndDate != null && entitlementEndDate.compareTo(new LocalDate(clock.getUTCNow(),accountTimeZone)) <= 0) {
    return EntitlementState.CANCELLED;
  }
  try {
    BlockingAggregator blocking=checker.getBlockedStatus(subscriptionBase,context);
    return blocking != null && blocking.isBlockEntitlement() ? EntitlementState.BLOCKED : EntitlementState.ACTIVE;
  }
 catch (  BlockingApiException e) {
    throw new EntitlementApiException(e);
  }
}
