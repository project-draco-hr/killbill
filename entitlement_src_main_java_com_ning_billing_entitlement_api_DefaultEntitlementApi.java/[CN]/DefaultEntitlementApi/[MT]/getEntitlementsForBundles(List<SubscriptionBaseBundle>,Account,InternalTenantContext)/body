{
  final Map<UUID,List<SubscriptionBase>> subscriptionsPerBundle=subscriptionInternalApi.getSubscriptionsForAccount(context);
  final List<Entitlement> result=new LinkedList<Entitlement>();
  for (  final SubscriptionBaseBundle bundle : bundles) {
    final List<Entitlement> entitlements=getAllEntitlementsForBundleId(bundle.getAccountId(),account.getTimeZone(),bundle.getExternalKey(),subscriptionsPerBundle.get(bundle.getId()),context);
    result.addAll(entitlements);
  }
  return result;
}
