{
  List<Notification> processedNotifications=new ArrayList<Notification>();
synchronized (notifications) {
    Iterator<Notification> it=notifications.iterator();
    while (it.hasNext()) {
      Notification cur=it.next();
      if (cur.isAvailableForProcessing(clock.getUTCNow())) {
        handler.handleReadyNotification(cur.getNotificationKey());
        DefaultNotification processedNotification=new DefaultNotification(cur.getId(),hostname,clock.getUTCNow().plus(config.getDaoClaimTimeMs()),NotificationLifecycleState.PROCESSED,cur.getNotificationKey(),cur.getEffectiveDate());
        it.remove();
        processedNotifications.add(processedNotification);
      }
    }
    if (processedNotifications.size() > 0) {
      notifications.addAll(processedNotifications);
    }
  }
}
