{
  try {
    SecurityUtils.getSecurityManager();
    shiroConfigured=true;
  }
 catch (  UnavailableSecurityManagerException ignored) {
    try {
      final Factory<SecurityManager> factory=new IniSecurityManagerFactory(securityConfig.getShiroResourcePath());
      final SecurityManager securityManager=factory.getInstance();
      SecurityUtils.setSecurityManager(securityManager);
      shiroConfigured=true;
    }
 catch (    ConfigurationException e) {
      log.warn(String.format("Unable to configure Shiro [%s] - RBAC WILL BE DISABLED!",e.getLocalizedMessage()));
      shiroConfigured=false;
    }
  }
}
