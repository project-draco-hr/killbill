{
  final InternalTenantContext internalCallContext=internalCallContextFactory.createInternalTenantContext(subscriptionId,ObjectType.SUBSCRIPTION,tenantContext);
  List<RolledUpUsage> result=new ArrayList<RolledUpUsage>();
  DateTime prevDate=null;
  for (  DateTime curDate : transitionTimes) {
    if (prevDate != null) {
      for (      String unitType : unitTypes) {
        final RolledUpUsageModelDao usageForSubscription=rolledUpUsageDao.getUsageForSubscription(subscriptionId,prevDate,curDate,unitType,internalCallContext);
        result.add(new DefaultRolledUpUsage(usageForSubscription));
      }
    }
    prevDate=curDate;
  }
  return result;
}
