{
  final DateTime startTime=clock.getUTCNow();
  final AccountJson accountJson=createAccountWithPMBundleAndSubscriptionAndWaitForFirstInvoice();
  final DateTime endTime=clock.getUTCNow();
  final InvoiceJsonSimple invoice=getInvoicesForAccount(accountJson.getAccountId()).get(1);
  final DateTime creditEffectiveDate=clock.getUTCNow();
  final BigDecimal creditAmount=BigDecimal.ONE;
  createCreditForInvoice(accountJson.getAccountId(),invoice.getInvoiceId(),creditAmount,clock.getUTCNow(),creditEffectiveDate);
  final PaymentJson postedPayment=getPaymentsForAccount(accountJson.getAccountId()).get(0);
  final BigDecimal refundAmount=BigDecimal.ONE;
  createRefund(postedPayment.getPaymentId(),refundAmount);
  final BigDecimal chargebackAmount=BigDecimal.ONE;
  createChargeBack(postedPayment.getPaymentId(),chargebackAmount);
  verifyPayments(accountJson.getAccountId(),startTime,endTime,refundAmount,chargebackAmount);
  verifyInvoices(accountJson.getAccountId(),startTime,endTime);
  verifyCredits(accountJson.getAccountId(),startTime,endTime,creditAmount);
  verifyBundles(accountJson.getAccountId(),startTime,endTime);
}
