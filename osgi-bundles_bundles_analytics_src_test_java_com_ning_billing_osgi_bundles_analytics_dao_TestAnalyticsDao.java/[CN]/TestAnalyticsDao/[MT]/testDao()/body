{
  final AnalyticsDao analyticsDao=new AnalyticsDao(logService,killbillAPI,killbillDataSource);
  Assert.assertNull(analyticsDao.getAccountById(account.getId(),callContext));
  final BusinessAccountModelDao accountModelDao=new BusinessAccountModelDao(account,accountRecordId,BigDecimal.ONE,invoice,payment,3,auditLog,tenantRecordId,reportGroup);
  analyticsSqlDao.create(accountModelDao.getTableName(),accountModelDao,callContext);
  Assert.assertEquals(analyticsDao.getAccountById(account.getId(),callContext),new BusinessAccount(accountModelDao));
  analyticsSqlDao.deleteByAccountRecordId(accountModelDao.getTableName(),accountModelDao.getAccountRecordId(),accountModelDao.getTenantRecordId(),callContext);
  Assert.assertNull(analyticsDao.getAccountById(account.getId(),callContext));
}
