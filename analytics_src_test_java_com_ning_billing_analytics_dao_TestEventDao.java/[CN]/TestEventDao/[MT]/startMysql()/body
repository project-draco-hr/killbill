{
  final String ddl=IOUtils.toString(EventDao.class.getResourceAsStream("/com/ning/billing/analytics/ddl.sql"));
  helper.startMysql();
  helper.initDb(ddl);
  final IProduct product=new MockProduct("platinium","subscription",ProductCategory.BASE);
  final IPlan plan=new MockPlan("platinum-monthly",product);
  final IPlanPhase phase=new MockPhase(PhaseType.EVERGREEN,plan,MockDuration.UNLIMITED(),25.95);
  final BusinessSubscription prevSubscription=new BusinessSubscription(plan,phase,Currency.USD,new DateTime(DateTimeZone.UTC),ISubscription.SubscriptionState.ACTIVE,UUID.randomUUID(),UUID.randomUUID());
  final BusinessSubscription nextSubscription=new BusinessSubscription(plan,phase,Currency.USD,new DateTime(DateTimeZone.UTC),ISubscription.SubscriptionState.CANCELLED,UUID.randomUUID(),UUID.randomUUID());
  final BusinessSubscriptionEvent event=BusinessSubscriptionEvent.subscriptionCancelled(plan);
  final DateTime requestedTimestamp=new DateTime(DateTimeZone.UTC);
  transition=new BusinessSubscriptionTransition(KEY,requestedTimestamp,event,prevSubscription,nextSubscription);
  final IDBI dbi=helper.getDBI();
  dao=dbi.onDemand(EventDao.class);
  try {
    dao.test();
  }
 catch (  Throwable t) {
    Assert.fail(t.toString());
  }
}
