{
  this.delegate=delegate;
  final InternalTenantContext context=new InternalTenantContext(null,null);
  sourcesCache=delegate.getSources(context);
  metricsCache=delegate.getMetrics(context);
  eventCategoriesCache=delegate.getEventCategories(context);
  sourceIdsMetricIdsCache=new HashMap<Integer,Set<Integer>>();
  for (  final SourceRecordIdAndMetricRecordId both : delegate.getMetricIdsForAllSources(context)) {
    final int sourceId=both.getSourceId();
    final int metricId=both.getMetricId();
    Set<Integer> metricIds=sourceIdsMetricIdsCache.get(sourceId);
    if (metricIds == null) {
      metricIds=new HashSet<Integer>();
      sourceIdsMetricIdsCache.put(sourceId,metricIds);
    }
    metricIds.add(metricId);
  }
}
