{
  final LinkedList<SubscriptionEvent> result=new LinkedList<SubscriptionEvent>();
  for (  Entitlement cur : entitlements) {
    final SubscriptionBase base=((DefaultEntitlement)cur).getSubscriptionBase();
    final List<SubscriptionBaseTransition> baseTransitions=base.getAllTransitions();
    for (    SubscriptionBaseTransition tr : baseTransitions) {
      final SubscriptionEventType eventType=toEventType(tr.getTransitionType());
      if (eventType == null) {
        continue;
      }
      final SubscriptionEvent event=toSubscriptionEvent(tr,eventType,accountTimeZone);
      insertSubscriptionEvent(event,result);
      if (tr.getTransitionType() == SubscriptionBaseTransitionType.CREATE || tr.getTransitionType() == SubscriptionBaseTransitionType.TRANSFER) {
        final SubscriptionEvent billingEvent=toSubscriptionEvent(tr,SubscriptionEventType.START_BILLING,accountTimeZone);
        insertSubscriptionEvent(event,result);
      }
    }
  }
  sanitizeForBaseRecreateEvents(result);
  return result;
}
