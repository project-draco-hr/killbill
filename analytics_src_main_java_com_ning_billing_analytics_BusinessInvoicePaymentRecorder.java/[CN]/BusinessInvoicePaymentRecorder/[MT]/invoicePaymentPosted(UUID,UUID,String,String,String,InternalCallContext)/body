{
  if (paymentId == null) {
    return;
  }
  final Account account;
  try {
    account=accountApi.getAccountById(accountId,context.toCallContext());
  }
 catch (  AccountApiException e) {
    log.warn("Ignoring payment {}: account {} does not exist",paymentId,accountId);
    return;
  }
  final Payment payment;
  try {
    payment=paymentApi.getPayment(paymentId,context.toCallContext());
  }
 catch (  PaymentApiException e) {
    log.warn("Ignoring payment {}: payment does not exist",paymentId);
    return;
  }
  final InvoicePayment invoicePayment=invoicePaymentApi.getInvoicePaymentForAttempt(paymentId,context.toCallContext());
  final PaymentMethod paymentMethod;
  try {
    paymentMethod=paymentApi.getPaymentMethod(account,payment.getPaymentMethodId(),true,context.toCallContext());
  }
 catch (  PaymentApiException e) {
    log.warn("Ignoring payment {}: payment method {} does not exist",paymentId,payment.getPaymentMethodId());
    return;
  }
  createPayment(account,invoicePayment,payment,paymentMethod,extFirstPaymentRefId,extSecondPaymentRefId,message,context);
}
