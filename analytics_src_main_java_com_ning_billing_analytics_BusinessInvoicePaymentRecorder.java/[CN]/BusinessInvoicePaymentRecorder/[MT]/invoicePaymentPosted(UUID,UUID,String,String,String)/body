{
  final Account account;
  try {
    account=accountApi.getAccountById(accountId);
  }
 catch (  AccountApiException e) {
    log.warn("Ignoring payment {}: account {} does not exist",paymentId,accountId);
    return;
  }
  final Payment payment;
  try {
    payment=paymentApi.getPayment(paymentId);
  }
 catch (  PaymentApiException e) {
    log.warn("Ignoring payment {}: payment does not exist",paymentId);
    return;
  }
  final InvoicePayment invoicePayment=invoicePaymentApi.getInvoicePaymentForAttempt(paymentId);
  final PaymentMethod paymentMethod;
  try {
    paymentMethod=paymentApi.getPaymentMethod(account,payment.getPaymentMethodId(),true);
  }
 catch (  PaymentApiException e) {
    log.warn("Ignoring payment {}: payment method {} does not exist",paymentId,payment.getPaymentMethodId());
    return;
  }
  createPayment(account,invoicePayment,payment,paymentMethod,extFirstPaymentRefId,extSecondPaymentRefId,message);
}
