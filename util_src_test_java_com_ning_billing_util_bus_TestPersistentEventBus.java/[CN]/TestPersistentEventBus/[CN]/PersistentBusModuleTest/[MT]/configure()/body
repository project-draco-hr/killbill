{
  bind(Clock.class).to(ClockMock.class).asEagerSingleton();
  bind(ClockMock.class).asEagerSingleton();
  final DBTestingHelper helper=KillbillTestSuiteWithEmbeddedDB.getDBTestingHelper();
  if (helper.isUsingLocalInstance()) {
    bind(IDBI.class).toProvider(DBIProvider.class).asEagerSingleton();
    final DbiConfig config=new ConfigurationObjectFactory(System.getProperties()).build(DbiConfig.class);
    bind(DbiConfig.class).toInstance(config);
  }
 else {
    final IDBI dbi=helper.getDBI();
    bind(IDBI.class).toInstance(dbi);
  }
  install(new BusModule(BusType.PERSISTENT));
}
