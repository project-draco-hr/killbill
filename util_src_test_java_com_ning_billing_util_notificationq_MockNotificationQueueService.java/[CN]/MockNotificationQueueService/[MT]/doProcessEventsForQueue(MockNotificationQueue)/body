{
  int result=0;
  final List<Notification> processedNotifications=new ArrayList<Notification>();
  final List<Notification> oldNotifications=new ArrayList<Notification>();
  List<Notification> readyNotifications=queue.getReadyNotifications();
  for (  final Notification cur : readyNotifications) {
    final NotificationKey key=deserializeEvent(cur.getNotificationKeyClass(),cur.getNotificationKey());
    queue.getHandler().handleReadyNotification(key,cur.getEffectiveDate(),cur.getAccountRecordId(),cur.getTenantRecordId());
    final DefaultNotification processedNotification=new DefaultNotification(-1L,cur.getId(),getHostname(),getHostname(),"MockQueue",getClock().getUTCNow().plus(CLAIM_TIME_MS),PersistentQueueEntryLifecycleState.PROCESSED,cur.getNotificationKeyClass(),cur.getNotificationKey(),cur.getAccountId(),cur.getEffectiveDate(),cur.getAccountRecordId(),cur.getTenantRecordId());
    oldNotifications.add(cur);
    processedNotifications.add(processedNotification);
    result++;
  }
  queue.markProcessedNotifications(oldNotifications,processedNotifications);
  return result;
}
