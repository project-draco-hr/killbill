{
  int retry=2;
  do {
    try {
      int result=0;
      Iterator<String> it=queues.keySet().iterator();
      while (it.hasNext()) {
        final String queueName=it.next();
        final NotificationQueue cur=queues.get(queueName);
        if (cur != null) {
          result+=doProcessEventsForQueue((MockNotificationQueue)cur);
        }
      }
      return result;
    }
 catch (    ConcurrentModificationException e) {
      retry--;
    }
  }
 while (retry > 0);
  return 0;
}
