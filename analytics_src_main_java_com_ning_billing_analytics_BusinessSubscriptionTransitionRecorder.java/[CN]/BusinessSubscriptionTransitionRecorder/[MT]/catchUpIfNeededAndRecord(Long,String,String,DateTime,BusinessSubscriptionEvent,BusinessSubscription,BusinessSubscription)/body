{
  if (BusinessSubscriptionEvent.EventType.ADD.equals(event.getEventType())) {
    final List<BusinessSubscriptionTransition> transitions=sqlDao.getTransitionForSubscription(nextSubscription.getSubscriptionId().toString());
    if (transitions != null && transitions.size() > 0) {
      final BusinessSubscriptionTransition firstTransition=transitions.get(0);
      if (firstTransition.getPreviousSubscription() == null) {
        final BusinessSubscriptionTransition updatedFirstTransition=new BusinessSubscriptionTransition(firstTransition.getTotalOrdering(),firstTransition.getExternalKey(),firstTransition.getAccountKey(),firstTransition.getRequestedTimestamp(),firstTransition.getEvent(),nextSubscription,firstTransition.getNextSubscription());
        sqlDao.updateTransition(updatedFirstTransition.getTotalOrdering(),updatedFirstTransition);
      }
    }
  }
  record(totalOrdering,externalKey,accountKey,requestedDateTime,event,prevSubscription,nextSubscription);
}
