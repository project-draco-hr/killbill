{
  final Handle h=dbi.open();
  final MySqlGlobalLockerDao dao=h.attach(MySqlGlobalLockerDao.class);
  final boolean obtained=dao.lock(lockName,timeout);
  if (obtained) {
    return new GlobalLock(){
      @Override public void release(){
        try {
          dao.releaseLock(lockName);
        }
  finally {
          h.close();
        }
      }
    }
;
  }
 else {
    h.close();
    return null;
  }
}
