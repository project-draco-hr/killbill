{
  PriceList priceList=catalog.getPriceListFromName(to.getPriceListName());
  if (priceList == null) {
    priceList=findPriceList(from.toPlanSpecifier(),catalog);
    to=new PlanSpecifier(to.getProductName(),to.getProductCategory(),to.getBillingPeriod(),priceList.getName());
  }
  ActionPolicy policy=getPlanChangePolicy(from,to,catalog);
  if (policy == ActionPolicy.ILLEGAL) {
    throw new IllegalPlanChange(from,to);
  }
  PlanAlignmentChange alignment=getPlanChangeAlignment(from,to,catalog);
  return new PlanChangeResult(priceList,policy,alignment);
}
