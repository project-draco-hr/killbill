{
  try {
    module=new InvoiceModuleWithEmbeddedDb();
    final String invoiceDdl=IOUtils.toString(DefaultInvoiceDao.class.getResourceAsStream("/com/ning/billing/invoice/ddl.sql"));
    final String entitlementDdl=IOUtils.toString(DefaultInvoiceDao.class.getResourceAsStream("/com/ning/billing/entitlement/ddl.sql"));
    module.startDb();
    module.initDb(invoiceDdl);
    module.initDb(entitlementDdl);
    final Injector injector=Guice.createInjector(Stage.DEVELOPMENT,module);
    invoiceDao=injector.getInstance(InvoiceDao.class);
    invoiceDao.test();
    invoiceItemDao=module.getInvoiceItemDao();
    invoicePaymentDao=module.getIDBI().onDemand(InvoicePaymentSqlDao.class);
    BusService busService=injector.getInstance(BusService.class);
    ((DefaultEventBusService)busService).startBus();
    assertTrue(true);
  }
 catch (  Throwable t) {
    fail(t.toString());
  }
}
