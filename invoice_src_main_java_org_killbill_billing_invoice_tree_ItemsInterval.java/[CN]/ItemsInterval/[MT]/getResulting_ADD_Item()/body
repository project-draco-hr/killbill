{
  final Set<UUID> repairedIds=new HashSet<UUID>();
  final ListIterator<Item> it=items.listIterator(items.size());
  while (it.hasPrevious()) {
    final Item cur=it.previous();
switch (cur.getAction()) {
case ADD:
      if (!repairedIds.contains(cur.getId())) {
        return cur;
      }
    break;
case CANCEL:
  if (cur.getLinkedId() != null) {
    repairedIds.add(cur.getLinkedId());
  }
break;
}
}
return null;
}
