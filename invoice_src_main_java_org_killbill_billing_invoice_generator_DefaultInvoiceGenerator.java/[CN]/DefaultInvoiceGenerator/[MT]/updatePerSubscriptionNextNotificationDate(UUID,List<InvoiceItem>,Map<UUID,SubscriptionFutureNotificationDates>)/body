{
  for (  final InvoiceItem item : newProposedItems) {
    if ((item.getEndDate() != null) && (item.getAmount() == null || item.getAmount().compareTo(BigDecimal.ZERO) >= 0)) {
      SubscriptionFutureNotificationDates subscriptionFutureNotificationDates=perSubscriptionFutureNotificationDates.get(subscriptionId);
      if (subscriptionFutureNotificationDates == null) {
        subscriptionFutureNotificationDates=new SubscriptionFutureNotificationDates();
        perSubscriptionFutureNotificationDates.put(subscriptionId,subscriptionFutureNotificationDates);
      }
      subscriptionFutureNotificationDates.updateNextRecurringDateIfRequired(item.getEndDate());
    }
  }
}
