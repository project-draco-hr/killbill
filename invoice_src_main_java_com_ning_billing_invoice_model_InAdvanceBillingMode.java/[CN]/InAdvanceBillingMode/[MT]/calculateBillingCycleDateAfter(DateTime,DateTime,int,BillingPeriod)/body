{
  DateTime proposedDate=billingCycleDate;
  while (!proposedDate.isAfter(date)) {
    proposedDate=proposedDate.plusMonths(billingPeriod.getNumberOfMonths());
    if (proposedDate.dayOfMonth().get() != billingCycleDay) {
      int lastDayOfMonth=proposedDate.dayOfMonth().getMaximumValue();
      if (lastDayOfMonth < billingCycleDay) {
        proposedDate=new DateTime(proposedDate.getYear(),proposedDate.getMonthOfYear(),lastDayOfMonth,proposedDate.getHourOfDay(),proposedDate.getMinuteOfHour(),proposedDate.getSecondOfMinute(),proposedDate.getMillisOfSecond());
      }
 else {
        proposedDate=new DateTime(proposedDate.getYear(),proposedDate.getMonthOfYear(),billingCycleDay,proposedDate.getHourOfDay(),proposedDate.getMinuteOfHour(),proposedDate.getSecondOfMinute(),proposedDate.getMillisOfSecond());
      }
    }
  }
  return proposedDate;
}
