{
  LocalDate result=null;
  BlockingState lastEntry;
  lastEntry=(!subscriptionEntitlementStates.isEmpty()) ? subscriptionEntitlementStates.get(subscriptionEntitlementStates.size() - 1) : null;
  if (lastEntry != null && DefaultEntitlementApi.ENT_STATE_CANCELLED.equals(lastEntry.getStateName())) {
    result=new LocalDate(lastEntry.getEffectiveDate(),account.getTimeZone());
  }
  lastEntry=(!bundleEntitlementStates.isEmpty()) ? bundleEntitlementStates.get(bundleEntitlementStates.size() - 1) : null;
  if (lastEntry != null && DefaultEntitlementApi.ENT_STATE_CANCELLED.equals(lastEntry.getStateName())) {
    final LocalDate localDate=new LocalDate(lastEntry.getEffectiveDate(),account.getTimeZone());
    result=((result == null) || (localDate.compareTo(result) < 0)) ? localDate : result;
  }
  lastEntry=(!accountEntitlementStates.isEmpty()) ? accountEntitlementStates.get(accountEntitlementStates.size() - 1) : null;
  if (lastEntry != null && DefaultEntitlementApi.ENT_STATE_CANCELLED.equals(lastEntry.getStateName())) {
    final LocalDate localDate=new LocalDate(lastEntry.getEffectiveDate(),account.getTimeZone());
    result=((result == null) || (localDate.compareTo(result) < 0)) ? localDate : result;
  }
  entitlementEffectiveEndDate=result;
}
