{
  logService.log(LogService.LOG_INFO,"Starting rebuild of Analytics subscriptions for account " + accountId);
  final BusinessAccountModelDao bac=bacFactory.createBusinessAccount(accountId,context);
  final Collection<BusinessSubscriptionTransitionModelDao> bsts=bstFactory.createBusinessSubscriptionTransitions(accountId,bac.getAccountRecordId(),bac.getTenantRecordId(),context);
  final Collection<BusinessBundleSummaryModelDao> bbss=bbsFactory.createBusinessBundleSummaries(accountId,bac.getAccountRecordId(),bsts,bac.getTenantRecordId(),context);
  sqlDao.inTransaction(new Transaction<Void,BusinessAnalyticsSqlDao>(){
    @Override public Void inTransaction(    final BusinessAnalyticsSqlDao transactional,    final TransactionStatus status) throws Exception {
      updateInTransaction(bac,bbss,bsts,transactional,context);
      return null;
    }
  }
);
  logService.log(LogService.LOG_INFO,"Finished rebuild of Analytics subscriptions for account " + accountId);
}
