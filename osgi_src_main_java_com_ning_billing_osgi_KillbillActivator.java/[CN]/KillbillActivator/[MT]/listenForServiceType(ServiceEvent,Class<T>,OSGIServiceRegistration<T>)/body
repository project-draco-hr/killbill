{
  final ServiceReference serviceReference=event.getServiceReference();
  final String pluginName=(String)serviceReference.getProperty(OSGIPluginProperties.PLUGIN_NAME_PROP);
  if (pluginName == null) {
    return true;
  }
  final T theService=(T)context.getService(serviceReference);
  if (theService == null || !claz.isAssignableFrom(theService.getClass())) {
    return false;
  }
switch (event.getType()) {
case ServiceEvent.REGISTERED:
    registration.registerService(pluginName,theService);
  break;
case ServiceEvent.UNREGISTERING:
registration.unregisterService(pluginName);
break;
default :
break;
}
return true;
}
