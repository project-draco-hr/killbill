{
  final Map<UUID,DateTime> result=new HashMap<UUID,DateTime>();
  for (  final InvoiceItemModelDao item : invoiceItems) {
    if (item.getType() == InvoiceItemType.RECURRING) {
      if ((item.getEndDate() != null) && (item.getAmount() == null || item.getAmount().compareTo(BigDecimal.ZERO) >= 0)) {
        result.put(item.getSubscriptionId(),dateAndTimeZoneContext.computeUTCDateTimeFromLocalDate(item.getEndDate()));
      }
    }
  }
  return result;
}
