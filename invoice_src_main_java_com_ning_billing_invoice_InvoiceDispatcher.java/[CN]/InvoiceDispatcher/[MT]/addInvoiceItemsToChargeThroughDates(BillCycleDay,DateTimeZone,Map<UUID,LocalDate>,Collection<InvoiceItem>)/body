{
  for (  final InvoiceItem item : items) {
    final UUID subscriptionId=item.getSubscriptionId();
    final LocalDate endDate=(item.getEndDate() != null) ? item.getEndDate() : item.getStartDate();
    if (chargeThroughDates.containsKey(subscriptionId)) {
      if (chargeThroughDates.get(subscriptionId).isBefore(endDate)) {
        final LocalDate ctd=InvoiceDateUtils.calculateBillingCycleDateOnOrAfter(endDate,accountTimeZone,billCycleDay.getDayOfMonthLocal());
        chargeThroughDates.put(subscriptionId,ctd);
      }
    }
 else {
      chargeThroughDates.put(subscriptionId,endDate);
    }
  }
}
