{
  DefaultPrice price=new DefaultPrice(BigDecimal.ZERO,Currency.USD);
  MockInternationalPrice recurringPrice=new MockInternationalPrice(price);
  MockPlanPhase phase=new MockPlanPhase(recurringPrice,null);
  MockPlan plan=new MockPlan(phase);
  Subscription subscription=new MockSubscription();
  DateTime effectiveDate=buildDateTime(2011,1,1);
  BillingEvent event=new DefaultBillingEvent(subscription,effectiveDate,plan,phase,null,recurringPrice,BillingPeriod.MONTHLY,15,BillingModeType.IN_ADVANCE,"testEvent");
  BillingEventSet events=new BillingEventSet();
  events.add(event);
  DateTime targetDate=buildDateTime(2011,1,15);
  InvoiceGenerator generator=new DefaultInvoiceGenerator();
  Invoice invoice=generator.generateInvoice(UUID.randomUUID(),events,null,targetDate,Currency.USD);
  assertEquals(invoice.getNumberOfItems(),1);
  assertEquals(invoice.getTotalAmount().compareTo(ZERO),0);
}
