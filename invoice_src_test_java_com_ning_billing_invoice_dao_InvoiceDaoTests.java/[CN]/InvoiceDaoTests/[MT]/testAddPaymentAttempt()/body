{
  UUID accountId=UUID.randomUUID();
  DateTime targetDate=new DateTime(2011,10,6,0,0,0,0);
  Invoice invoice=new InvoiceDefault(accountId,targetDate,Currency.USD);
  DateTime paymentAttemptDate=new DateTime(2011,6,24,12,14,36,0);
  dao.createInvoice(invoice);
  dao.notifyFailedPayment(invoice.getId().toString(),paymentAttemptDate.toDate());
  invoice=dao.getInvoice(invoice.getId().toString());
  assertTrue(invoice.getLastPaymentAttempt().equals(paymentAttemptDate));
}
