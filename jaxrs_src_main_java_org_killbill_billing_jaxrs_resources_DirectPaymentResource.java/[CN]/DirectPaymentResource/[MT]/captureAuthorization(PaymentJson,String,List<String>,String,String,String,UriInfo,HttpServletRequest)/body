{
  final Iterable<PluginProperty> pluginProperties=extractPluginProperties(pluginPropertiesString);
  final CallContext callContext=context.createContext(createdBy,reason,comment,request);
  final UUID directPaymentId=UUID.fromString(directPaymentIdStr);
  final DirectPayment initialPayment=directPaymentApi.getPayment(directPaymentId,false,pluginProperties,callContext);
  final Account account=accountUserApi.getAccountById(initialPayment.getAccountId(),callContext);
  final Currency currency=json.getCurrency() == null ? account.getCurrency() : Currency.valueOf(json.getCurrency());
  final DirectPayment payment=directPaymentApi.createCapture(account,directPaymentId,json.getAmount(),currency,pluginProperties,callContext);
  return uriBuilder.buildResponse(uriInfo,DirectPaymentResource.class,"getDirectPayment",payment.getId());
}
