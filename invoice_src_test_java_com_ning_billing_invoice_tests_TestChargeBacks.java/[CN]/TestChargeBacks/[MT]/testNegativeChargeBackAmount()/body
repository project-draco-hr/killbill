{
  try {
    final Invoice invoice=createAndPersistInvoice(invoiceSqlDao,invoiceItemSqlDao,clock,THIRTY,CURRENCY,callContext,internalCallContextFactory);
    final InvoicePayment payment=createAndPersistPayment(invoicePaymentApi,clock,invoice.getId(),THIRTY,CURRENCY,callContext);
    invoicePaymentApi.createChargeback(payment.getId(),BigDecimal.ONE.negate(),callContext);
  }
 catch (  TransactionFailedException expected) {
    throw (InvoiceApiException)expected.getCause();
  }
}
