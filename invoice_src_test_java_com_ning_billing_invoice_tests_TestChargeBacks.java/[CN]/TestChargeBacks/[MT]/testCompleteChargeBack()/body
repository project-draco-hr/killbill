{
  final Invoice invoice=createAndPersistInvoice(invoiceSqlDao,invoiceItemSqlDao,clock,THIRTY,CURRENCY,callContext,internalCallContextFactory);
  final InvoicePayment payment=createAndPersistPayment(invoiceApi,clock,invoice.getId(),THIRTY,CURRENCY,internalCallContext);
  invoicePaymentApi.createChargeback(payment.getId(),THIRTY,callContext);
  final BigDecimal amount=invoicePaymentApi.getRemainingAmountPaid(payment.getId(),callContext);
  assertTrue(amount.compareTo(BigDecimal.ZERO) == 0);
}
