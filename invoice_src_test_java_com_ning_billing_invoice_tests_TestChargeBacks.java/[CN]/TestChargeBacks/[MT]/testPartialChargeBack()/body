{
  final Invoice invoice=createAndPersistInvoice(invoiceSqlDao,invoiceItemSqlDao,clock,THIRTY,CURRENCY,callContext,internalCallContextFactory);
  final InvoicePayment payment=createAndPersistPayment(invoicePaymentApi,clock,invoice.getId(),THIRTY,CURRENCY,callContext);
  invoicePaymentApi.createChargeback(payment.getId(),FIFTEEN,callContext);
  final BigDecimal amount=invoicePaymentApi.getRemainingAmountPaid(payment.getId(),callContext);
  assertTrue(amount.compareTo(FIFTEEN) == 0);
}
