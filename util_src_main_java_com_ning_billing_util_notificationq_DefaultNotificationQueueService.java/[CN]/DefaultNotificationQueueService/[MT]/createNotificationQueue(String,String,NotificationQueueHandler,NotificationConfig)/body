{
  if (svcName == null || queueName == null || handler == null || config == null) {
    throw new RuntimeException("Need to specify all parameters");
  }
  String compositeName=svcName + ":" + queueName;
  NotificationQueue result=null;
synchronized (queues) {
    result=queues.get(compositeName);
    if (result == null) {
      result=new NotificationQueue(dbi,clock,svcName,queueName,handler,config);
      queues.put(compositeName,result);
    }
 else {
      log.warn("Queue for svc {} and name {} already exist",svcName,queueName);
    }
  }
  return result;
}
