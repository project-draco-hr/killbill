{
  Subscription subscription=(Subscription)dao.getSubscriptionFromId(event.getSubscriptionId());
  if (subscription == null) {
    log.warn("Failed to retrieve subscription for id %s",event.getSubscriptionId());
    return;
  }
  if (event.getType() == EventType.PHASE) {
    insertNextPhaseEvent(subscription);
  }
  try {
    eventBus.post(subscription.getTransitionFromEvent(event));
  }
 catch (  EventBusException e) {
    log.warn("Failed to post entitlement event " + event,e);
  }
}
