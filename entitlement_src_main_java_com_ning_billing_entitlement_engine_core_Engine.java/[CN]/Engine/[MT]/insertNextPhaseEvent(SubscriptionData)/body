{
  DateTime now=clock.getUTCNow();
  TimedPhase nextTimedPhase=planAligner.getNextTimedPhase(subscription,subscription.getCurrentPlan(),now,subscription.getCurrentPlanStart());
  PhaseEvent nextPhaseEvent=PhaseEventData.getNextPhaseEvent(nextTimedPhase,subscription,now);
  if (nextPhaseEvent != null) {
    dao.createNextPhaseEvent(subscription.getId(),nextPhaseEvent);
  }
}
