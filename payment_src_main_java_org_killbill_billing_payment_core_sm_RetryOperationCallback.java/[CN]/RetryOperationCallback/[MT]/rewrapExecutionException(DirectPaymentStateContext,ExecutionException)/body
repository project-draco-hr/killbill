{
  if (e.getCause() instanceof OperationException) {
    return (OperationException)e.getCause();
  }
 else   if (e.getCause() instanceof LockFailedException) {
    final String format=String.format("Failed to lock account %s",directPaymentStateContext.getAccount().getExternalKey());
    logger.error(String.format(format),e);
    return new OperationException(e,getOperationResultOnException(directPaymentStateContext));
  }
 else {
    logger.warn("RetryOperationCallback failed for account {}",directPaymentStateContext.getAccount().getExternalKey(),e);
    return new OperationException(e,getOperationResultOnException(directPaymentStateContext));
  }
}
