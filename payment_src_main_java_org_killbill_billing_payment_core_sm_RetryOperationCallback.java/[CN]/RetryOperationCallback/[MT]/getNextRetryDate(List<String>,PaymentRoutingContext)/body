{
  DateTime candidate=null;
  for (  final String pluginName : paymentControlPluginNames) {
    final PaymentRoutingPluginApi plugin=paymentControlPluginRegistry.getServiceForName(pluginName);
    if (plugin != null) {
      try {
        final OnFailurePaymentRoutingResult result=plugin.onFailureCall(paymentControlContext,paymentStateContext.getProperties());
        if (candidate == null) {
          candidate=result.getNextRetryDate();
        }
 else         if (result.getNextRetryDate() != null) {
          candidate=candidate.compareTo(result.getNextRetryDate()) > 0 ? result.getNextRetryDate() : candidate;
        }
      }
 catch (      final PaymentRoutingApiException e) {
        logger.warn("Plugin " + pluginName + " failed to return next retryDate for payment "+ paymentControlContext.getPaymentExternalKey(),e);
        return candidate;
      }
    }
  }
  return candidate;
}
