{
  DateTime now=clock.getUTCNow();
  List<DisabledDuration> disabledDuration=new ArrayList<OverdueEventCalculator.DisabledDuration>();
  SortedSet<BillingEvent> billingEvents=new TreeSet<BillingEvent>();
  disabledDuration.add(new DisabledDuration(now,now.plusDays(2)));
  billingEvents.add(createRealEvent(now.minusDays(1),subscription1));
  billingEvents.add(createRealEvent(now.plusDays(1),subscription1));
  SortedSet<BillingEvent> results=odc.eventsToRemove(disabledDuration,billingEvents,subscription1);
  assertEquals(results.size(),2);
  assertEquals(results.first().getEffectiveDate(),now);
  assertEquals(results.first().getRecurringPrice(),BigDecimal.ZERO);
  assertEquals(results.first().getTransitionType(),SubscriptionTransitionType.CANCEL);
  assertEquals(results.last().getEffectiveDate(),now.plusDays(2));
  assertEquals(results.last().getRecurringPrice(),billingEvents.first().getRecurringPrice());
  assertEquals(results.last().getTransitionType(),SubscriptionTransitionType.RE_CREATE);
}
