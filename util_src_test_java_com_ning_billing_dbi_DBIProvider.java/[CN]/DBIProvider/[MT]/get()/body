{
  final BoneCPConfig dbConfig=new BoneCPConfig();
  dbConfig.setJdbcUrl(config.getJdbcUrl());
  dbConfig.setUsername(config.getUsername());
  dbConfig.setPassword(config.getPassword());
  dbConfig.setMinConnectionsPerPartition(config.getMinIdle());
  dbConfig.setMaxConnectionsPerPartition(config.getMaxActive());
  dbConfig.setConnectionTimeout(config.getConnectionTimeout().getPeriod(),config.getConnectionTimeout().getUnit());
  dbConfig.setPartitionCount(1);
  dbConfig.setDefaultTransactionIsolation("REPEATABLE_READ");
  dbConfig.setDisableJMX(false);
  dbConfig.setLazyInit(true);
  final BoneCPDataSource ds=new BoneCPDataSource(dbConfig);
  final DBI dbi=new DBI(ds);
  final SQLLog log=new Log4JLog();
  dbi.setSQLLog(log);
  return dbi;
}
