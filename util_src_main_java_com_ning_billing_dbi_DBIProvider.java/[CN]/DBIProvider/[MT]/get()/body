{
  final BoneCPConfig dbConfig=new BoneCPConfig();
  dbConfig.setJdbcUrl(config.getJdbcUrl());
  dbConfig.setUsername(config.getUsername());
  dbConfig.setPassword(config.getPassword());
  dbConfig.setMinConnectionsPerPartition(config.getMinIdle());
  dbConfig.setMaxConnectionsPerPartition(config.getMaxActive());
  dbConfig.setConnectionTimeout(config.getConnectionTimeout().getPeriod(),config.getConnectionTimeout().getUnit());
  dbConfig.setPartitionCount(1);
  dbConfig.setDefaultTransactionIsolation("READ_COMMITTED");
  dbConfig.setDisableJMX(false);
  final BoneCPDataSource ds=new BoneCPDataSource(dbConfig);
  final DBI dbi=new DBI(ds);
  final SQLLog log=new Log4JLog();
  dbi.setSQLLog(log);
  final JdbiGroupStrategy jdbiGroupStrategy=new SqlJdbiGroupStrategy();
  final TimingCollector timingCollector=new MetricsTimingCollector(metricsRegistry,jdbiGroupStrategy,TimeUnit.MILLISECONDS,TimeUnit.SECONDS);
  dbi.setTimingCollector(timingCollector);
  return dbi;
}
