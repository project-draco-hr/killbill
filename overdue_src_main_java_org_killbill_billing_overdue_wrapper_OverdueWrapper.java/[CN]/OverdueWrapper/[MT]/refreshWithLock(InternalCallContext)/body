{
  final BillingState billingState=billingState(context);
  final String previousOverdueStateName=MoreObjects.firstNonNull(api.getBlockingStateForService(overdueable.getId(),BlockingStateType.ACCOUNT,OverdueService.OVERDUE_SERVICE_NAME,context).getStateName(),OverdueWrapper.CLEAR_STATE_NAME);
  final OverdueState currentOverdueState=overdueStateSet.findState(previousOverdueStateName);
  final OverdueState nextOverdueState=overdueStateSet.calculateOverdueState(billingState,clock.getToday(billingState.getAccountTimeZone()));
  overdueStateApplicator.apply(overdueStateSet,billingState,overdueable,currentOverdueState,nextOverdueState,context);
  return nextOverdueState;
}
