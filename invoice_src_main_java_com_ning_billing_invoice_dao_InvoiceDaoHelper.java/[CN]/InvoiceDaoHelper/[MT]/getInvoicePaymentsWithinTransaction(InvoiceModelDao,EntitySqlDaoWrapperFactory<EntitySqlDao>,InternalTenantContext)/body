{
  final InvoicePaymentSqlDao invoicePaymentSqlDao=entitySqlDaoWrapperFactory.become(InvoicePaymentSqlDao.class);
  final String invoiceId=invoice.getId().toString();
  final List<InvoicePaymentModelDao> invoicePayments=invoicePaymentSqlDao.getPaymentsForInvoice(invoiceId,context);
  for (  final InvoicePaymentModelDao cur : invoicePayments) {
    if (cur.getCurrency() != cur.getProcessedCurrency()) {
      invoice.setProcessedCurrency(cur.getProcessedCurrency());
      break;
    }
  }
  invoice.addPayments(invoicePayments);
}
