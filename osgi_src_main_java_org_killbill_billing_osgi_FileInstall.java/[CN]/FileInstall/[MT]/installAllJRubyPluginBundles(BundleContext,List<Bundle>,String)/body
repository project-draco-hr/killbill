{
  if (jrubyBundlePath == null) {
    return;
  }
  final List<PluginRubyConfig> pluginRubyConfigs=pluginFinder.getLatestRubyPlugins();
  int i=0;
  for (  final PluginRubyConfig cur : pluginRubyConfigs) {
    final String uniqueJrubyBundlePath="jruby-" + cur.getPluginName();
    InputStream tweakedInputStream=null;
    try {
      logger.info("Installing JRuby bundle for plugin {} ",uniqueJrubyBundlePath);
      tweakedInputStream=tweakRubyManifestToBeUnique(jrubyBundlePath,++i);
      final Bundle bundle=context.installBundle(uniqueJrubyBundlePath,tweakedInputStream);
      ((DefaultPluginConfigServiceApi)pluginConfigServiceApi).registerBundle(bundle.getBundleId(),cur);
      installedBundles.add(bundle);
    }
 catch (    IOException e) {
      logger.warn("Failed to open file {}",jrubyBundlePath);
    }
 finally {
      if (tweakedInputStream != null) {
        try {
          tweakedInputStream.close();
        }
 catch (        IOException ignore) {
        }
      }
    }
  }
}
