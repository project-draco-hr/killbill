{
  eventsDao.inTransaction(new Transaction<Void,EventSqlDao>(){
    @Override public Void inTransaction(    EventSqlDao dao,    TransactionStatus status) throws Exception {
      cancelNextChangeEventFromTransaction(subscriptionId,dao);
      cancelNextPhaseEventFromTransaction(subscriptionId,dao);
      for (      final EntitlementEvent cur : changeEvents) {
        dao.insertEvent(cur);
        recordFutureNotificationFromTransaction(dao,cur.getEffectiveDate(),new NotificationKey(){
          @Override public String toString(){
            return cur.getId().toString();
          }
        }
);
      }
      return null;
    }
  }
);
}
