{
  final Date ctd=(subscription.getChargedThroughDate() != null) ? subscription.getChargedThroughDate().toDate() : null;
  final Date ptd=(subscription.getPaidThroughDate() != null) ? subscription.getPaidThroughDate().toDate() : null;
  subscriptionsDao.inTransaction(new Transaction<Void,SubscriptionSqlDao>(){
    @Override public Void inTransaction(    SubscriptionSqlDao transactionalDao,    TransactionStatus status) throws Exception {
      transactionalDao.updateSubscription(subscription.getId().toString(),subscription.getActiveVersion(),ctd,ptd);
      return null;
    }
  }
);
}
