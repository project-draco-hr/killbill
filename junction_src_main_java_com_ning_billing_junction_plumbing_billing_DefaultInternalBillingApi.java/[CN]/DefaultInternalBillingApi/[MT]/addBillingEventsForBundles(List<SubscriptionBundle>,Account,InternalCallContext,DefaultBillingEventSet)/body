{
  for (  final SubscriptionBundle bundle : bundles) {
    final List<Subscription> subscriptions=entitlementApi.getSubscriptionsForBundle(bundle.getId(),context);
    final List<Tag> bundleTags=tagApi.getTags(bundle.getId(),ObjectType.BUNDLE,context);
    boolean found_AUTO_INVOICING_OFF=false;
    for (    final Tag cur : bundleTags) {
      if (ControlTagType.AUTO_INVOICING_OFF.getId().equals(cur.getTagDefinitionId())) {
        found_AUTO_INVOICING_OFF=true;
        break;
      }
    }
    if (found_AUTO_INVOICING_OFF) {
      for (      final Subscription subscription : subscriptions) {
        result.getSubscriptionIdsWithAutoInvoiceOff().add(subscription.getId());
      }
    }
 else {
      addBillingEventsForSubscription(subscriptions,bundle,account,context,result);
    }
  }
}
