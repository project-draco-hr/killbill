{
  final EntitlementJsonNoEvents input=new EntitlementJsonNoEvents(accountId,null,null,bundleExternalKey,null,productName,productCategory,billingPeriod,PriceListSet.DEFAULT_PRICELIST_NAME,null,null);
  String baseJson=mapper.writeValueAsString(input);
  final Map<String,String> queryParams=waitCompletion ? getQueryParamsForCallCompletion("5") : DEFAULT_EMPTY_QUERY;
  Response response=doPost(JaxrsResource.ENTITLEMENTS_PATH,baseJson,queryParams,DEFAULT_HTTP_TIMEOUT_SEC * 1000);
  Assert.assertEquals(response.getStatusCode(),Status.CREATED.getStatusCode());
  final String location=response.getHeader("Location");
  Assert.assertNotNull(location);
  response=doGetWithUrl(location,DEFAULT_EMPTY_QUERY,DEFAULT_HTTP_TIMEOUT_SEC);
  Assert.assertEquals(response.getStatusCode(),Status.OK.getStatusCode());
  baseJson=response.getResponseBody();
  final EntitlementJsonNoEvents objFromJson=mapper.readValue(baseJson,EntitlementJsonNoEvents.class);
  Assert.assertTrue(objFromJson.equalsNoSubscriptionIdNoStartDateNoCTD(input));
  return objFromJson;
}
