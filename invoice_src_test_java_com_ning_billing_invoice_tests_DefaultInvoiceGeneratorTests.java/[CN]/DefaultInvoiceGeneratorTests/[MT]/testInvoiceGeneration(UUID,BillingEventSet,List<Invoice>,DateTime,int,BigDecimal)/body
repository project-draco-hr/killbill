{
  Currency currency=Currency.USD;
  Invoice invoice=generator.generateInvoice(accountId,events,existingInvoices,targetDate,currency);
  assertNotNull(invoice);
  assertEquals(invoice.getNumberOfItems(),expectedNumberOfItems);
  existingInvoices.add(invoice);
  distributeItems(existingInvoices);
  assertEquals(invoice.getBalance(),expectedAmount);
}
