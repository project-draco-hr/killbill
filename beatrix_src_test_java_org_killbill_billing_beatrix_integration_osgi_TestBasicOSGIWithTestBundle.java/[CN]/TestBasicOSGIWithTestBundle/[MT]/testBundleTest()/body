{
  final TestActivatorWithAssertion assertTor=new TestActivatorWithAssertion(dbi);
  assertTor.assertPluginInitialized();
  final Account account=createAccountWithNonOsgiPaymentMethod(getAccountData(1));
  assertTor.assertPluginReceievdAccountCreationEvent(account.getExternalKey());
  final PaymentPluginApi paymentPluginApi=getTestPluginPaymentApi();
  final UUID paymentId=UUID.randomUUID();
  final BigDecimal paymentAmount=new BigDecimal("14.32");
  final PaymentInfoPlugin r=paymentPluginApi.processPayment(account.getId(),paymentId,account.getPaymentMethodId(),paymentAmount,Currency.USD,ImmutableList.<PluginProperty>of(),callContext);
  assertTor.assertPluginCreatedPayment(paymentId,account.getPaymentMethodId(),paymentAmount);
}
