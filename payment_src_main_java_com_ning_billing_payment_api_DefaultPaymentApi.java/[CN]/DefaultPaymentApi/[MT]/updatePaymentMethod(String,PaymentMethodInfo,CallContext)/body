{
  return new WithAccountLock<PaymentMethodInfo>().processAccountWithLock(locker,accountKey,new WithAccountLockCallback<PaymentMethodInfo>(){
    @Override public PaymentMethodInfo doOperation() throws PaymentApiException {
      try {
        final PaymentProviderPlugin plugin=getPaymentProviderPlugin(accountKey);
        return plugin.updatePaymentMethod(accountKey,paymentMethodInfo);
      }
 catch (      PaymentPluginApiException e) {
        throw new PaymentApiException(e,ErrorCode.PAYMENT_UPD_PAYMENT_METHOD,accountKey,e.getMessage());
      }
    }
  }
);
}
