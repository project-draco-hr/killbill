{
  return new WithAccountLock<PaymentInfoEvent>().processAccountWithLock(locker,accountKey,new WithAccountLockCallback<PaymentInfoEvent>(){
    @Override public PaymentInfoEvent doOperation() throws PaymentApiException {
      try {
        final Account account=accountUserApi.getAccountByKey(accountKey);
        return createPayment(account,invoiceId,context);
      }
 catch (      AccountApiException e) {
        throw new PaymentApiException(e);
      }
    }
  }
);
}
