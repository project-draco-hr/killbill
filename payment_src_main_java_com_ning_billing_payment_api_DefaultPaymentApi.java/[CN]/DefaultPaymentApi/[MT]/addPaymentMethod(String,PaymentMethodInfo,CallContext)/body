{
  return new WithAccountLock<String>().processAccountWithLock(locker,accountKey,new WithAccountLockCallback<String>(){
    @Override public String doOperation() throws PaymentApiException {
      try {
        final PaymentProviderPlugin plugin=getPaymentProviderPlugin(accountKey);
        return plugin.addPaymentMethod(accountKey,paymentMethod);
      }
 catch (      PaymentPluginApiException e) {
        throw new PaymentApiException(e,ErrorCode.PAYMENT_ADD_PAYMENT_METHOD,accountKey,e.getMessage());
      }
    }
  }
);
}
