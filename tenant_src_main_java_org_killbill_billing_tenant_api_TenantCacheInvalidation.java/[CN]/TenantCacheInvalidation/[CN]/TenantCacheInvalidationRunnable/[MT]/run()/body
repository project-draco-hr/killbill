{
  if (parent.isStopped) {
    return;
  }
  final List<TenantBroadcastModelDao> entries=broadcastDao.getLatestEntriesFrom(parent.getLatestRecordIdProcessed().get());
  for (  TenantBroadcastModelDao cur : entries) {
    if (parent.isStopped()) {
      return;
    }
    try {
      final TenantKeyAndCookie tenantKeyAndCookie=extractTenantKeyAndCookie(cur.getType());
      if (tenantKeyAndCookie != null) {
        final CacheInvalidationCallback callback=parent.getCacheInvalidation(tenantKeyAndCookie.getTenantKey());
        if (callback != null) {
          final InternalTenantContext tenantContext=new InternalTenantContext(cur.getTenantRecordId(),null);
          callback.invalidateCache(tenantKeyAndCookie.getTenantKey(),tenantKeyAndCookie.getCookie(),tenantContext);
        }
 else {
          logger.warn("Failed to find CacheInvalidationCallback for " + cur.getType());
        }
      }
    }
  finally {
      parent.setLatestRecordIdProcessed(cur.getRecordId());
    }
  }
}
