{
  final HtmlEmail email;
  try {
    email=new HtmlEmail();
    email.setSmtpPort(config.getSmtpPort());
    if (config.useSmtpAuth()) {
      email.setAuthentication(config.getSmtpUserName(),config.getSmtpPassword());
    }
    email.setHostName(config.getSmtpServerName());
    email.setFrom(config.getDefaultFrom());
    email.setSubject(subject);
    email.setHtmlMsg(htmlBody);
    if (to != null) {
      for (      final String recipient : to) {
        email.addTo(recipient);
      }
    }
    if (cc != null) {
      for (      final String recipient : cc) {
        email.addCc(recipient);
      }
    }
    email.setSSL(true);
    email.send();
  }
 catch (  EmailException ee) {
    log.warn("Failed to send e-mail",ee);
  }
}
