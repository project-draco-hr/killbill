{
  final PaymentMethodPlugin paymentMethodPlugin;
  if (withPluginInfo) {
    try {
      final PaymentPluginApi pluginApi=getPaymentPluginApi(paymentMethodModelDao.getPluginName());
      paymentMethodPlugin=pluginApi.getPaymentMethodDetail(paymentMethodModelDao.getAccountId(),paymentMethodModelDao.getId(),buildTenantContext(context));
    }
 catch (    PaymentPluginApiException e) {
      log.warn("Error retrieving payment method " + paymentMethodModelDao.getId() + " from plugin "+ paymentMethodModelDao.getPluginName(),e);
      throw new PaymentApiException(ErrorCode.PAYMENT_GET_PAYMENT_METHODS,paymentMethodModelDao.getAccountId(),paymentMethodModelDao.getId());
    }
  }
 else {
    paymentMethodPlugin=null;
  }
  return new DefaultPaymentMethod(paymentMethodModelDao,paymentMethodPlugin);
}
