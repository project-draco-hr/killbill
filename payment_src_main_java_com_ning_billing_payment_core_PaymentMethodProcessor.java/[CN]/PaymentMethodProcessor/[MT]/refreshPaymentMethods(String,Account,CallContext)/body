{
  List<PaymentMethod> result=new LinkedList<PaymentMethod>();
  PaymentPluginApi pluginApi=null;
  try {
    pluginApi=pluginRegistry.getPlugin(pluginName);
    List<PaymentMethodPlugin> pluginPms=pluginApi.getPaymentMethodDetails(account.getExternalKey());
    for (    PaymentMethodPlugin cur : pluginPms) {
      PaymentMethod input=new DefaultPaymentMethod(account.getId(),pluginName,cur);
      PaymentMethodModelDao pmModel=new PaymentMethodModelDao(input.getId(),input.getAccountId(),input.getPluginName(),input.isActive(),input.getPluginDetail().getExternalPaymentMethodId());
      paymentDao.insertPaymentMethod(pmModel,context);
      result.add(input);
    }
  }
 catch (  PaymentPluginApiException e) {
    throw new PaymentApiException(ErrorCode.PAYMENT_REFRESH_PAYMENT_METHOD,account.getId(),e.getErrorMessage());
  }
  return result;
}
