{
  final U reHydratedEntity=sqlDao.getById(entityId,context);
  final Long reHydratedEntityRecordId=sqlDao.getRecordId(entityId,context);
  final U entity=Objects.firstNonNull(reHydratedEntity,entities.get(entityId));
  final Long entityRecordId=Objects.firstNonNull(reHydratedEntityRecordId,entityRecordIds.get(entityId));
  final TableName tableName=retrieveTableNameFromEntity(entity);
  final Long historyRecordId;
  if (tableName.getHistoryTableName() != null) {
    historyRecordId=insertHistory(entityRecordId,entity,changeType,context);
  }
 else {
    historyRecordId=entityRecordId;
  }
  insertAudits(tableName,historyRecordId,changeType,context);
}
