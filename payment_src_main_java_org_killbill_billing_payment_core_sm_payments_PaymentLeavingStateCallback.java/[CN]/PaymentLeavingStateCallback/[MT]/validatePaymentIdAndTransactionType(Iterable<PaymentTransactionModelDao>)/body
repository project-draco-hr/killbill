{
  for (  final PaymentTransactionModelDao paymentTransactionModelDao : existingPaymentTransactions) {
    if (!paymentTransactionModelDao.getPaymentId().equals(paymentStateContext.getPaymentId())) {
      throw new PaymentApiException(ErrorCode.PAYMENT_INVALID_PARAMETER,paymentTransactionModelDao.getId(),"does not belong to payment " + paymentStateContext.getPaymentId());
    }
    if (paymentStateContext.getTransactionType() != null && paymentTransactionModelDao.getTransactionType() != paymentStateContext.getTransactionType()) {
      throw new PaymentApiException(ErrorCode.PAYMENT_INVALID_PARAMETER,paymentTransactionModelDao.getId(),"has a transaction type of " + paymentTransactionModelDao.getTransactionType() + " instead of requested "+ paymentStateContext.getTransactionType());
    }
  }
}
