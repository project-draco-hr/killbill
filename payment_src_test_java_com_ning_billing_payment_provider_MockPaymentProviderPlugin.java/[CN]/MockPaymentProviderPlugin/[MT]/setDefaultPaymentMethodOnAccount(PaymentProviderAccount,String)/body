{
  if (paymentMethodId != null && account != null) {
    accounts.put(account.getAccountKey(),new PaymentProviderAccount.Builder().copyFrom(account).setDefaultPaymentMethod("paypal").build());
    List<PaymentMethodInfo> paymentMethodsToUpdate=new ArrayList<PaymentMethodInfo>();
    for (    PaymentMethodInfo paymentMethod : paymentMethods.values()) {
      if (account.getAccountKey().equals(paymentMethod.getAccountId()) && !paymentMethodId.equals(paymentMethod.getId())) {
        if (paymentMethod instanceof PaypalPaymentMethodInfo) {
          PaypalPaymentMethodInfo paypalPaymentMethod=(PaypalPaymentMethodInfo)paymentMethod;
          paymentMethodsToUpdate.add(new PaypalPaymentMethodInfo.Builder(paypalPaymentMethod).setDefaultMethod(false).build());
        }
 else         if (paymentMethod instanceof CreditCardPaymentMethodInfo) {
          CreditCardPaymentMethodInfo ccPaymentMethod=(CreditCardPaymentMethodInfo)paymentMethod;
          paymentMethodsToUpdate.add(new CreditCardPaymentMethodInfo.Builder(ccPaymentMethod).setDefaultMethod(false).build());
        }
      }
    }
    for (    PaymentMethodInfo paymentMethod : paymentMethodsToUpdate) {
      paymentMethods.put(paymentMethod.getId(),paymentMethod);
    }
  }
}
