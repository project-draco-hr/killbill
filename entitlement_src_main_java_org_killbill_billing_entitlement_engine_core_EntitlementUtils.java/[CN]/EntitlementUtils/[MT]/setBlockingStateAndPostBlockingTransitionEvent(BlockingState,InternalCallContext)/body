{
  final BlockingAggregator previousState=getBlockingStateFor(state.getBlockedId(),state.getType(),clock.getUTCNow(),context);
  dao.setBlockingState(state,clock,context);
  final BlockingAggregator currentState=getBlockingStateFor(state.getBlockedId(),state.getType(),state.getEffectiveDate(),context);
  if (previousState != null && currentState != null) {
    postBlockingTransitionEvent(state.getId(),state.getEffectiveDate(),state.getBlockedId(),state.getType(),state.getService(),previousState,currentState,context);
  }
}
