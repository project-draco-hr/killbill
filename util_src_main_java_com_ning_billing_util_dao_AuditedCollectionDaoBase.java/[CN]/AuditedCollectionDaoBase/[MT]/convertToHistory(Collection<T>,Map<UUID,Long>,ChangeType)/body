{
  final List<EntityHistory<T>> histories=new ArrayList<EntityHistory<T>>();
  for (  final T entity : entities) {
    final UUID id=entity.getId();
    final Long recordId=recordIds.get(id);
    if (recordId == null) {
      throw new IllegalStateException("recordId for object " + entity.getClass() + " is null ");
    }
    histories.add(new EntityHistory<T>(id,recordId,entity,changeType));
  }
  return histories;
}
