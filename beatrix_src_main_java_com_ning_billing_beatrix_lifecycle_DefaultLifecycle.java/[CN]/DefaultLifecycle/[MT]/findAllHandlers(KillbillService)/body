{
  final Multimap<LifecycleLevel,LifecycleHandler<? extends KillbillService>> methodsInService=HashMultimap.create();
  final Class<? extends KillbillService> clazz=service.getClass();
  for (  final Method method : clazz.getMethods()) {
    final LifecycleHandlerType annotation=method.getAnnotation(LifecycleHandlerType.class);
    if (annotation != null) {
      final LifecycleLevel level=annotation.value();
      final LifecycleHandler<? extends KillbillService> handler=new LifecycleHandler<KillbillService>(service,method);
      methodsInService.put(level,handler);
    }
  }
  return methodsInService;
}
