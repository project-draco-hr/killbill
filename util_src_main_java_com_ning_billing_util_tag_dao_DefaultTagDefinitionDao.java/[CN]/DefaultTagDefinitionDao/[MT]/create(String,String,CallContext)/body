{
  if (isControlTagName(definitionName)) {
    throw new TagDefinitionApiException(ErrorCode.TAG_DEFINITION_CONFLICTS_WITH_CONTROL_TAG,definitionName);
  }
  try {
    return tagDefinitionSqlDao.inTransaction(new Transaction<TagDefinition,TagDefinitionSqlDao>(){
      @Override public TagDefinition inTransaction(      final TagDefinitionSqlDao transactional,      final TransactionStatus status) throws Exception {
        final TagDefinition existingDefinition=tagDefinitionSqlDao.getByName(definitionName);
        if (existingDefinition != null) {
          throw new TagDefinitionApiException(ErrorCode.TAG_DEFINITION_ALREADY_EXISTS,definitionName);
        }
        final TagDefinition definition=new DefaultTagDefinition(definitionName,description,false);
        tagDefinitionSqlDao.create(definition,context);
        return definition;
      }
    }
);
  }
 catch (  TransactionFailedException exception) {
    if (exception.getCause() instanceof TagDefinitionApiException) {
      throw (TagDefinitionApiException)exception.getCause();
    }
 else {
      throw exception;
    }
  }
}
