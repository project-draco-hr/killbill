{
  this.account=new AccountJsonSimple(account.getId().toString(),account.getExternalKey());
  this.bundles=new LinkedList<BundleJsonWithSubscriptions>();
  for (  final BundleTimeline cur : bundles) {
    this.bundles.add(new BundleJsonWithSubscriptions(account.getId(),cur));
  }
  this.invoices=new LinkedList<InvoiceJsonWithBundleKeys>();
  for (  final Invoice cur : invoices) {
    this.invoices.add(new InvoiceJsonWithBundleKeys(cur.getAmountPaid(),cur.getAmountCredited(),cur.getId().toString(),cur.getInvoiceDate(),cur.getTargetDate(),Integer.toString(cur.getInvoiceNumber()),cur.getBalance(),cur.getAccountId().toString(),getBundleExternalKey(cur,bundles)));
  }
  this.payments=new LinkedList<PaymentJsonWithBundleKeys>();
  for (  final PaymentAttempt cur : payments) {
    final String status=cur.getPaymentId() != null ? "Success" : "Failed";
    final BigDecimal paidAmount=cur.getPaymentId() != null ? cur.getAmount() : BigDecimal.ZERO;
    this.payments.add(new PaymentJsonWithBundleKeys(cur.getAmount(),paidAmount,cur.getInvoiceId(),cur.getPaymentId(),cur.getCreatedDate(),cur.getUpdatedDate(),cur.getRetryCount(),cur.getCurrency().toString(),status,cur.getAccountId(),getBundleExternalKey(cur.getInvoiceId(),invoices,bundles)));
  }
}
