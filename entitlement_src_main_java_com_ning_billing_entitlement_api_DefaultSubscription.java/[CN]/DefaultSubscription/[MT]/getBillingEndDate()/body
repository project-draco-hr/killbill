{
  final DateTime futureOrCurrentEndDateForSubscription=getSubscriptionBase().getEndDate() != null ? getSubscriptionBase().getEndDate() : getSubscriptionBase().getFutureEndDate();
  final DateTime futureOrCurrentEndDateForBaseSubscription;
  if (getBaseSubscription() == null) {
    futureOrCurrentEndDateForBaseSubscription=null;
  }
 else {
    futureOrCurrentEndDateForBaseSubscription=getBaseSubscription().getEndDate() != null ? getBaseSubscription().getEndDate() : getBaseSubscription().getFutureEndDate();
  }
  final DateTime futureOrCurrentEndDate;
  if (futureOrCurrentEndDateForBaseSubscription != null && futureOrCurrentEndDateForBaseSubscription.isBefore(futureOrCurrentEndDateForSubscription)) {
    futureOrCurrentEndDate=futureOrCurrentEndDateForBaseSubscription;
  }
 else {
    futureOrCurrentEndDate=futureOrCurrentEndDateForSubscription;
  }
  return futureOrCurrentEndDate != null ? new LocalDate(futureOrCurrentEndDate,getAccountTimeZone()) : null;
}
