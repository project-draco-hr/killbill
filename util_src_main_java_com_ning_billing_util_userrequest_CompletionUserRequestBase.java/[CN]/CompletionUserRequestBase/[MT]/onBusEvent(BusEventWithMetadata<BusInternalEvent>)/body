{
  final BusInternalEvent curEvent=busEventWithMetadata.getEvent();
  if (busEventWithMetadata.getUserToken() == null || !busEventWithMetadata.getUserToken().equals(userToken)) {
    return;
  }
  events.add(curEvent);
switch (curEvent.getBusEventType()) {
case ACCOUNT_CREATE:
    onAccountCreation((BusEventWithMetadata<AccountCreationInternalEvent>)curEvent);
  break;
case ACCOUNT_CHANGE:
onAccountChange((BusEventWithMetadata<AccountChangeInternalEvent>)curEvent);
break;
case SUBSCRIPTION_TRANSITION:
onSubscriptionTransition((BusEventWithMetadata<EffectiveSubscriptionInternalEvent>)curEvent);
break;
case INVOICE_EMPTY:
onEmptyInvoice((BusEventWithMetadata<NullInvoiceInternalEvent>)curEvent);
break;
case INVOICE_CREATION:
onInvoiceCreation((BusEventWithMetadata<InvoiceCreationInternalEvent>)curEvent);
break;
case PAYMENT_INFO:
onPaymentInfo((BusEventWithMetadata<PaymentInfoInternalEvent>)curEvent);
break;
case PAYMENT_ERROR:
onPaymentError((BusEventWithMetadata<PaymentErrorInternalEvent>)curEvent);
break;
default :
throw new RuntimeException("Unexpected event type " + curEvent.getBusEventType());
}
}
