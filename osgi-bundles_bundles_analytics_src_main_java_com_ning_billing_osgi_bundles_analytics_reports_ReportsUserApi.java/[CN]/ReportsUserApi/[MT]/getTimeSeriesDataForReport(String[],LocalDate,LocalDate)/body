{
  final Map<String,Map<String,List<XY>>> dataForReports=new ConcurrentHashMap<String,Map<String,List<XY>>>();
  fetchData(reportNames,dataForReports);
  filterValues(dataForReports,startDate,endDate);
  normalizeXValues(dataForReports,startDate,endDate);
  final List<NamedXYTimeSeries> results=new LinkedList<NamedXYTimeSeries>();
  for (  final String reportName : dataForReports.keySet()) {
    for (    final String pivotName : Ordering.natural().sortedCopy(dataForReports.get(reportName).keySet())) {
      final String timeSeriesName;
      if (NO_PIVOT.equals(pivotName)) {
        timeSeriesName=reportsConfiguration.getPrettyNameForReport(reportName);
      }
 else {
        timeSeriesName=String.format("%s (%s)",reportsConfiguration.getPrettyNameForReport(reportName),pivotName);
      }
      final List<XY> timeSeries=dataForReports.get(reportName).get(pivotName);
      results.add(new NamedXYTimeSeries(timeSeriesName,timeSeries));
    }
  }
  return results;
}
