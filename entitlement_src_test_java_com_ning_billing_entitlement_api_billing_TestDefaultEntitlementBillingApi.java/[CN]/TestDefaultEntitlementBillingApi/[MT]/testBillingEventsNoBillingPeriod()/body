{
  DateTime now=clock.getUTCNow();
  DateTime then=now.minusDays(1);
  Plan nextPlan=catalogService.getFullCatalog().findPlan("shotgun-annual",now);
  PlanPhase nextPhase=nextPlan.getAllPhases()[0];
  String nextPriceList=PriceListSet.DEFAULT_PRICELIST_NAME;
  SubscriptionTransition t=new SubscriptionTransitionData(zeroId,oneId,twoId,EventType.API_USER,ApiEventType.CREATE,then,now,null,null,null,null,SubscriptionState.ACTIVE,nextPlan,nextPhase,nextPriceList,true);
  transitions.add(t);
  AccountUserApi accountApi=new BrainDeadAccountUserApi(){
    @Override public Account getAccountById(    UUID accountId){
      return new BrainDeadAccount(){
        @Override public int getBillCycleDay(){
          return 32;
        }
      }
;
    }
  }
;
  DefaultEntitlementBillingApi api=new DefaultEntitlementBillingApi(dao,accountApi,catalogService);
  SortedSet<BillingEvent> events=api.getBillingEventsForAccount(new UUID(0L,0L));
  checkFirstEvent(events,nextPlan,32,oneId,now,nextPhase,ApiEventType.CREATE.toString());
}
