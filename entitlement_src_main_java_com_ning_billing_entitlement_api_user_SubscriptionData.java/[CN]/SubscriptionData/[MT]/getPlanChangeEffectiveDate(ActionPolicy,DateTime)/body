{
  if (policy == ActionPolicy.IMMEDIATE) {
    return requestedDate;
  }
  if (policy != ActionPolicy.END_OF_TERM) {
    throw new EntitlementError(String.format("Unexpected policy type %s",policy.toString()));
  }
  if (chargedThroughDate == null) {
    return requestedDate;
  }
 else {
    return chargedThroughDate.isBefore(requestedDate) ? requestedDate : chargedThroughDate;
  }
}
