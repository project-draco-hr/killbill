{
  for (  LyfecycleLevel level : LyfecycleLevel.values()) {
    log.info("Firing stage {}",level);
    Set<LifecycleHandler> handlers=handlersByLevel.get(level);
    for (    LifecycleHandler cur : handlers) {
      log.debug("Calling handler {}",cur.getMethod().getName());
      try {
        Method method=cur.getMethod();
        Object target=cur.getTarget();
        method.invoke(target);
      }
 catch (      Exception e) {
        log.warn("Failed to invoke lifecycle handler",e);
      }
    }
  }
}
