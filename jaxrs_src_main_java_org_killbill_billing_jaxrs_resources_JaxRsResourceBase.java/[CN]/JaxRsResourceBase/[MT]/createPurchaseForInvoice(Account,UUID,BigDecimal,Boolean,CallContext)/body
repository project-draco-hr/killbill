{
  final List<PluginProperty> properties=new ArrayList<PluginProperty>();
  final String paymentExternalKey=UUID.randomUUID().toString();
  final String transactionExternalKey=UUID.randomUUID().toString();
  final PluginProperty invoiceProperty=new PluginProperty("IPCD_INVOICE_ID",invoiceId.toString(),false);
  properties.add(invoiceProperty);
  paymentApi.createPurchaseWithPaymentControl(account,account.getPaymentMethodId(),null,amountToPay,account.getCurrency(),paymentExternalKey,transactionExternalKey,properties,createInvoicePaymentControlPluginApiPaymentOptions(externalPayment),callContext);
}
