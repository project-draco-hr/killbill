{
  super.setUp();
  final OSGIKillbillDataSource osgiKillbillDataSource=Mockito.mock(OSGIKillbillDataSource.class);
  final DataSource dataSource=Mockito.mock(DataSource.class);
  Mockito.when(osgiKillbillDataSource.getDataSource()).thenReturn(dataSource);
  final OSGIKillbillLogService osgiKillbillLogService=Mockito.mock(OSGIKillbillLogService.class);
  Mockito.doAnswer(new Answer(){
    @Override public Object answer(    final InvocationOnMock invocation) throws Throwable {
      logger.info(Arrays.toString(invocation.getArguments()));
      return null;
    }
  }
).when(osgiKillbillLogService).log(Mockito.anyInt(),Mockito.anyString());
  invoiceFactory=new BusinessInvoiceFactory(osgiKillbillLogService,null,BusinessExecutor.newCachedThreadPool());
}
