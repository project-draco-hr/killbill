{
  final List<Item> itemToConsider=new LinkedList<Item>();
  buildFromItems(itemToConsider,true,mergeMode);
  Iterator<Item> it=itemToConsider.iterator();
  while (it.hasNext()) {
    final Item cur=it.next();
    if (cur.getAction() == ItemAction.CANCEL && !mergeMode) {
      continue;
    }
    final Item result=new Item(cur.toProratedInvoiceItem(startDate,endDate),cur.getAction());
    if (cur.getAction() == ItemAction.CANCEL && result != null) {
      cur.incrementCurrentRepairedAmount(result.getAmount());
    }
    return result;
  }
  return null;
}
