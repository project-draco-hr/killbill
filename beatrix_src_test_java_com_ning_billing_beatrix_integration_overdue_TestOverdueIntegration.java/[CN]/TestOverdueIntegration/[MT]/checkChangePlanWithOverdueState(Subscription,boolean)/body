{
  if (shouldFail) {
    try {
      subscription.changePlan("Pistol",term,PriceListSet.DEFAULT_PRICELIST_NAME,clock.getUTCNow(),context);
    }
 catch (    EntitlementUserApiException e) {
      assertTrue(e.getCause() instanceof BlockingApiException);
    }
  }
 else {
    changeSubscriptionAndCheckForCompletion(subscription,"Pistol",BillingPeriod.MONTHLY,NextEvent.CHANGE);
  }
}
