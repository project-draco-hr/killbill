{
  SubscriptionData subscription=(SubscriptionData)dao.getSubscriptionFromId(subscriptionId);
  if (subscription == null) {
    new EntitlementBillingApiException(String.format("Unknwon subscription %s",subscriptionId));
  }
  SubscriptionBuilder builder=new SubscriptionBuilder(subscription).setChargedThroughDate(ctd).setPaidThroughDate(subscription.getPaidThroughDate());
  dao.updateSubscription(new SubscriptionData(builder));
}
