{
  final List<BusinessInvoice> invoicesToDelete=transactional.getInvoicesForAccount(accountId.toString(),context);
  final BusinessInvoiceItemSqlDao invoiceItemSqlDao=transactional.become(BusinessInvoiceItemSqlDao.class);
  for (  final BusinessInvoice businessInvoice : invoicesToDelete) {
    final List<BusinessInvoiceItem> invoiceItemsForInvoice=invoiceItemSqlDao.getInvoiceItemsForInvoice(businessInvoice.getInvoiceId().toString(),context);
    for (    final BusinessInvoiceItem invoiceItemToDelete : invoiceItemsForInvoice) {
      log.info("Deleting invoice item {}",invoiceItemToDelete.getItemId());
      invoiceItemSqlDao.deleteInvoiceItem(invoiceItemToDelete.getItemId().toString(),context);
    }
  }
  log.info("Deleting invoices for account {}",accountId);
  transactional.deleteInvoicesForAccount(accountId.toString(),context);
}
