{
  final AccountJson accountJson=createAccountNoPMBundleAndSubscriptionAndWaitForFirstInvoice();
  assertEquals(getInvoicesForAccount(accountJson.getAccountId()).size(),2);
  final BigDecimal chargeAmount=BigDecimal.TEN;
  final String bundleId=UUID.randomUUID().toString();
  final InvoiceJson invoiceWithItems=createExternalCharge(accountJson.getAccountId(),chargeAmount,bundleId,null,null);
  assertEquals(invoiceWithItems.getBalance().compareTo(chargeAmount),0);
  assertEquals(invoiceWithItems.getItems().size(),1);
  assertEquals(invoiceWithItems.getItems().get(0).getBundleId(),bundleId);
  assertEquals(getInvoicesForAccount(accountJson.getAccountId()).size(),3);
}
