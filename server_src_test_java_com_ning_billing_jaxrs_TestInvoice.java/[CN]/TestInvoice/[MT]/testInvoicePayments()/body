{
  clock.setTime(new DateTime(2012,4,25,0,3,42,0));
  final AccountJson accountJson=createAccountWithPMBundleAndSubscriptionAndWaitForFirstInvoice();
  final List<InvoiceJsonSimple> invoices=getInvoicesForAccount(accountJson.getAccountId());
  assertEquals(invoices.size(),2);
  for (  final InvoiceJsonSimple cur : invoices) {
    final List<PaymentJson> objFromJson=getPaymentsForInvoice(cur.getInvoiceId());
    if (cur.getAmount().compareTo(BigDecimal.ZERO) == 0) {
      assertEquals(objFromJson.size(),0);
    }
 else {
      assertEquals(objFromJson.size(),1);
      assertEquals(cur.getAmount().compareTo(objFromJson.get(0).getAmount()),0);
    }
  }
}
