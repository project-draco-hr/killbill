{
  final UUID accountId=UUID.randomUUID();
  final TagStore tagStore=new DefaultTagStore(accountId,ObjectType.ACCOUNT);
  final String definitionName="MixedTagTest";
  TagDefinition tagDefinition=null;
  try {
    tagDefinition=tagDefinitionDao.create(definitionName,"Test tag for some test purpose",internalCallContext);
  }
 catch (  TagDefinitionApiException e) {
    fail("Tag definition creation failed.",e);
  }
  final DescriptiveTag descriptiveTag=new DescriptiveTag(tagDefinition.getId());
  tagStore.add(descriptiveTag);
  assertEquals(tagStore.generateInvoice(),true);
  final ControlTag controlTag=new DefaultControlTag(ControlTagType.AUTO_INVOICING_OFF);
  tagStore.add(controlTag);
  assertEquals(tagStore.generateInvoice(),false);
  tagDao.saveEntities(accountId,ObjectType.ACCOUNT,tagStore.getEntityList(),internalCallContext);
  tagStore.clear();
  assertEquals(tagStore.getEntityList().size(),0);
  final Map<String,Tag> tagMap=tagDao.loadEntities(accountId,ObjectType.ACCOUNT,internalCallContext);
  assertEquals(tagMap.size(),2);
  boolean found_AUTO_INVOICING_OFF_tag=false;
  for (  Tag cur : tagMap.values()) {
    if (cur.getTagDefinitionId().equals(ControlTagType.AUTO_INVOICING_OFF.getId())) {
      found_AUTO_INVOICING_OFF_tag=true;
      break;
    }
  }
  assertEquals(found_AUTO_INVOICING_OFF_tag,true);
}
