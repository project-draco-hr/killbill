{
  final CacheManager cacheManager;
  try {
    final InputStream inputStream=UriAccessor.accessUri(cacheConfig.getCacheConfigLocation());
    cacheManager=CacheManager.create(inputStream);
  }
 catch (  IOException e) {
    throw new RuntimeException(e);
  }
catch (  URISyntaxException e) {
    throw new RuntimeException(e);
  }
  for (  final BaseCacheLoader cacheLoader : cacheLoaders) {
    cacheLoader.init();
    final Cache cache=cacheManager.getCache(cacheLoader.getCacheType().getCacheName());
    for (    final CacheLoader existingCacheLoader : cache.getRegisteredCacheLoaders()) {
      cache.unregisterCacheLoader(existingCacheLoader);
    }
    cache.registerCacheLoader(cacheLoader);
  }
  return cacheManager;
}
