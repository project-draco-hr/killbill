{
  CallContext context=new CallContextFactory(clock).createMigrationCallContext("Migration",CallOrigin.INTERNAL,UserType.MIGRATION,clock.getUTCNow(),clock.getUTCNow());
  Invoice migrationInvoice=new MigrationInvoice(accountId,clock.getUTCNow(),targetDate,currency);
  InvoiceItem migrationInvoiceItem=new MigrationInvoiceItem(migrationInvoice.getId(),targetDate,balance,currency);
  migrationInvoice.addInvoiceItem(migrationInvoiceItem);
  dao.create(migrationInvoice,context);
  return migrationInvoice.getId();
}
