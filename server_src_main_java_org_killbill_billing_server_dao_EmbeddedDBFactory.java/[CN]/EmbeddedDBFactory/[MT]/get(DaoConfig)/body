{
  final URI uri=URI.create(config.getJdbcUrl().substring(5));
  final String databaseName;
  final String schemeLocation;
  if (uri.getPath() != null) {
    schemeLocation=null;
    databaseName=uri.getPath().split("/")[1].split(";")[0];
  }
 else   if (uri.getSchemeSpecificPart() != null) {
    final String[] schemeParts=uri.getSchemeSpecificPart().split(":");
    schemeLocation=schemeParts[0];
    databaseName=schemeParts[1].split(";")[0];
  }
 else {
    schemeLocation=null;
    databaseName=null;
  }
  if ("mysql".equals(uri.getScheme())) {
    return new MySQLStandaloneDB(databaseName,config.getUsername(),config.getPassword(),config.getJdbcUrl());
  }
 else   if ("h2".equals(uri.getScheme()) && ("mem".equals(schemeLocation) || "file".equals(schemeLocation))) {
    return new H2EmbeddedDB(databaseName,config.getUsername(),config.getPassword(),config.getJdbcUrl());
  }
 else {
    return new GenericStandaloneDB(databaseName,config.getUsername(),config.getPassword(),config.getJdbcUrl());
  }
}
