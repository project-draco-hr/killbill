{
  if (baseSubscription.getState() != SubscriptionState.ACTIVE) {
    throw new EntitlementUserApiException(ErrorCode.ENT_CREATE_AO_BP_NON_ACTIVE,targetAddOnPlan.getName());
  }
  if (addonUtils.isAddonIncluded(baseSubscription,targetAddOnPlan)) {
    throw new EntitlementUserApiException(ErrorCode.ENT_CREATE_AO_ALREADY_INCLUDED,targetAddOnPlan.getName(),baseSubscription.getCurrentPlan().getProduct().getName());
  }
  if (!addonUtils.isAddonAvailable(baseSubscription,targetAddOnPlan)) {
    throw new EntitlementUserApiException(ErrorCode.ENT_CREATE_AO_NOT_AVAILABLE,targetAddOnPlan.getName(),baseSubscription.getCurrentPlan().getProduct().getName());
  }
}
