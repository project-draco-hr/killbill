{
  if (transactionExternalKey == null) {
    return;
  }
  final List<PaymentTransactionModelDao> transactions=paymentDao.getPaymentTransactionsByExternalKey(transactionExternalKey,tenantContext);
  final PaymentTransactionModelDao transactionAlreadyExists=Iterables.tryFind(transactions,new Predicate<PaymentTransactionModelDao>(){
    @Override public boolean apply(    final PaymentTransactionModelDao input){
      return input.getTransactionStatus() == TransactionStatus.SUCCESS;
    }
  }
).orNull();
  if (transactionAlreadyExists != null) {
    throw new PaymentApiException(ErrorCode.PAYMENT_ACTIVE_TRANSACTION_KEY_EXISTS,transactionExternalKey);
  }
}
