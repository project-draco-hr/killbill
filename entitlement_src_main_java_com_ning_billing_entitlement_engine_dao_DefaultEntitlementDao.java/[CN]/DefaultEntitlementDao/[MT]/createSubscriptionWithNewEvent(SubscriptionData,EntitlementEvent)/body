{
  final SubscriptionData subscriptionWithNewEvent=new SubscriptionData(subscription,null,clock);
  final List<EntitlementEvent> allEvents=new LinkedList<EntitlementEvent>();
  if (subscriptionWithNewEvent.getEvents() != null) {
    allEvents.addAll(subscriptionWithNewEvent.getEvents());
  }
  allEvents.add(newEvent);
  subscriptionWithNewEvent.rebuildTransitions(allEvents,catalogService.getFullCatalog());
  return subscriptionWithNewEvent;
}
