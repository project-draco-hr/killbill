{
  final Session previousSession=readSession(session.getId());
  if (SessionUtils.sameSession(previousSession,session)) {
    if (!SessionUtils.accessedRecently(previousSession,session)) {
      final DateTime lastAccessTime=new DateTime(session.getLastAccessTime(),DateTimeZone.UTC);
      final Long sessionId=Long.valueOf(session.getId().toString());
      jdbcSessionSqlDao.updateLastAccessTime(lastAccessTime,sessionId);
    }
 else     if (session instanceof SimpleSession) {
      ((SimpleSession)session).setLastAccessTime(previousSession.getLastAccessTime());
    }
  }
 else {
    jdbcSessionSqlDao.update(new SessionModelDao(session));
  }
}
